<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>71b735b6515e4ac48cb9a73c8bbc1152</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div class="cell code" data-execution_count="2"
data-cell_id="09e7c98e4b3249b6bca8dc064cf9dafa"
data-deepnote_cell_type="code" data-deepnote_to_be_reexecuted="false"
data-execution_millis="2697" data-execution_start="1683495452238"
data-source_hash="a79cff41">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> networkx <span class="im">as</span> nx</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tqdm <span class="im">import</span> tqdm</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> community </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> netwulf <span class="im">as</span> nw</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pymongo <span class="im">import</span> MongoClient</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> nltk</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.tokenize <span class="im">import</span> word_tokenize</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.corpus <span class="im">import</span> stopwords</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pymongo <span class="im">import</span> MongoClient</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> multiprocessing</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> wordcloud <span class="im">import</span> WordCloud</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> community</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> community <span class="im">import</span> best_partition</span></code></pre></div>
</div>
<div class="cell code" data-cell_id="5f0a4180dfa64439bec2f8b9a0ac5a3b"
data-deepnote_cell_type="code" data-deepnote_to_be_reexecuted="false"
data-execution_millis="5" data-execution_start="1683494087640"
data-source_hash="23599b6f">
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mongoclient():</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    client <span class="op">=</span> MongoClient(<span class="st">&quot;mongodb+srv://augusttollerup:YLdUGXAq0l1TenD3@cluster0.rx8hxlc.mongodb.net/&quot;</span>) <span class="co"># Replace with your MongoDB URL</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    db <span class="op">=</span> client[<span class="st">&#39;ComSoc&#39;</span>] <span class="co"># Replace with your database name</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    collection <span class="op">=</span> db[<span class="st">&#39;papers&#39;</span>] <span class="co"># Replace with your collection name</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> client, collection</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="3"
data-cell_id="bd72c27e2e95430aadd277be41c5e930"
data-deepnote_cell_type="code" data-deepnote_to_be_reexecuted="false"
data-execution_millis="15" data-execution_start="1683495455712"
data-source_hash="269b2bfc">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> bson <span class="im">import</span> json_util</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mongoDB(query <span class="op">=</span> {<span class="st">&#39;abstract&#39;</span>: {<span class="st">&#39;$ne&#39;</span>: <span class="va">None</span>}}, projection <span class="op">=</span> <span class="va">None</span>):</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Connect to MongoDB</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    client <span class="op">=</span> MongoClient(<span class="st">&quot;mongodb+srv://augusttollerup:YLdUGXAq0l1TenD3@cluster0.rx8hxlc.mongodb.net/&quot;</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>                    socketTimeoutMS<span class="op">=</span><span class="dv">300000</span>, </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>                    connectTimeoutMS<span class="op">=</span><span class="dv">300000</span>) <span class="co"># Replace with your MongoDB URL</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    db <span class="op">=</span> client[<span class="st">&#39;ComSoc&#39;</span>] <span class="co"># Replace with your database name</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    collection <span class="op">=</span> db[<span class="st">&#39;papers&#39;</span>] <span class="co"># Replace with your collection name</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> projection:</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>        cursor <span class="op">=</span> collection.find(query, projection)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>        cursor <span class="op">=</span> collection.find(query)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Query for documents with non-null &quot;abstract&quot; field</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    documents <span class="op">=</span> <span class="bu">list</span>(cursor)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert documents to pandas dataframe</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.DataFrame(documents)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Close MongoDB connection</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    client.close()</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span></code></pre></div>
</div>
<section id="explainer-notebook" class="cell markdown"
data-cell_id="e65411648b3d40a3946db7bf23eeb34d"
data-deepnote_cell_type="markdown">
<h1>Explainer notebook</h1>
<p>This project examines how Artificial intelligence has been talked
about in scientific papers over time. It has been examined how different
"communities" of papers (as defined by groups of papers referencing each
other) talk about the subject and how these communities and the topic
evolved over time.</p>
</section>
<section id="part-1---motivation" class="cell markdown"
data-cell_id="d84cd7b60c86416888c0657ece7bac26"
data-deepnote_cell_type="markdown">
<h2>Part 1 - Motivation</h2>
<p>Artificial intelligence has increasingly become a hot topic
throughout the past decades. AI has moved from being an existential
thread depicted on the silver screen depictions in dystopian science
fiction thrillers such as Terminator and the Matrix, to being an
intangible buzzword for pitching to investors to finally taking the
world by storm with the release of complex AI driven tools such as
DALL-E, Midjourney and ChatGPT. The graph below illustrates how the
frequency of google searches on "Artificial Intelligence" has evolved
during the past two decades (source: <a
href="https://trends.google.com/trends/"
class="uri">https://trends.google.com/trends/</a>).</p>
<center>Google Trends: Artificial Intelligence</center>
<p><span class="image placeholder"
data-original-image-src="google_trends_AI.png"
data-original-image-title="">Picture</span></p>
<p>From the outside, it seems that the way Artificial Intelligence is
being talked about has changed a lot over the past decades, and to many
people it may seem that it has not been talked about at all until
recently (as suggested by the above figure). Therfore we wanted to
examine these changes in a more quantitative manner, using the tools
that were introduced in the DTU 02467 Computational Social Science
Course.</p>
</section>
<section id="what-is-your-dataset" class="cell markdown"
data-cell_id="80e23874e78741d4bfe602a279e55771"
data-deepnote_cell_type="markdown">
<h3>What is your dataset?</h3>
<p>The raw dataset collected for this project consists of the paper ID,
title, abstract, year, citation count and references for 315.400 papers
(645 MB) published between 1990 and 2023, though not all papers
collected had information for every field queried. The data was
collected by querying "Artificial Intelligence" with keyword search
using the Semantic Scholar API, which limited the search depth to the
first 10.000 papers. Therefore up to 10.000 papers were collected for
each year examined. However, since the search was sorted by relevence,
it was assumed that the first 10.000 papers found using keyword search
would be sufficient to carry out the target analysis. Overall, it is
worth noting that the described datacollection approach is itself a
heuristic and the implications thereof in relation to the stated project
goal are discussed in the final chapter.</p>
</section>
<section id="why-did-you-choose-thisthese-particular-datasets"
class="cell markdown" data-cell_id="c7b61c0966a049ba910e4dcc63283ae8"
data-deepnote_cell_type="markdown">
<h3>Why did you choose this/these particular dataset(s)?</h3>
<p>We decided to query the Semantic Scholar API using the term
"Artificial Intelligence" rather than terms like "Machine learning" or
"Neural Networks" because we were more interested in getting an overview
over how AI is talked about in relation to other fields and society as a
whole rather than how the technical field of AI has evolved. From our
personal experience, it appears that "Artificial Intelligence" is not
commonly mentioned in technical papers discussing specific techniques
within AI and machine learning, while, on the other hand, the term is
commonly used in texts discussing the impact of the technology as a
whole instead of its technical implimentations. Though this analysis
could also have been carried out by examining texts found in many other
places, we found a few perceived advantages of focusing on scientific
articles. We assumed that scientific articles would be a less "dirty"
data source compared to collecting information from a more wide corpus
such as by searching on goolge. Thus the resulting analysis might give a
more clear image about what topics were being talked about at the time
of publishing, as the authors aim to write articles that are relevant at
the time of publishing and are more likely to be informed about the
general topic of AI. On a similair note, scientific articles are not as
opinionated as many other texts found on the internet. We were not
interested in finding out how people feel about AI at a given time, but
rather in which context the term existed.</p>
</section>
<section id="what-was-your-goal-for-the-end-users-experience"
class="cell markdown" data-cell_id="d907bf21e5f143699df819de0cb93e93"
data-deepnote_cell_type="markdown">
<h3>What was your goal for the end user’s experience?</h3>
<p>Artificial intelligence is a phrase that many people have never heard
of until recently. We would like to show the end user that it is a topic
that has been talked about for decades before the release of tools like
ChatGPT. At the same time, we would like to give the end user an
overview of how the topic has evolved with time.</p>
</section>
<section id="data-collection-process" class="cell markdown"
data-cell_id="ad585d6980a24c0495f4c2226cd1c2bf"
data-deepnote_cell_type="markdown">
<h3>Data collection process</h3>
<p>As we expected to partition the same dataset in multiple different
ways for our analysis, we found it useful to save all data in a database
using MongoDB. In this way, a pandas dataframe could quickly be
constructed by querying the database. Thus it was not necessary to store
the same data multiple times across different .csv files. Additionally,
the database could manage simultanious incomming write requests from
parallel processes, which were ID'ed by paper ID, such that no
duplicates were made and data integrity was protected by avoiding race
conditions.</p>
</section>
<div class="cell code" data-cell_id="4a411cafe30d46efa40e529e725ca375"
data-deepnote_cell_type="code" data-deepnote_to_be_reexecuted="false"
data-execution_millis="4" data-execution_start="1683494099759"
data-source_hash="4e7a8763">
<div class="sourceCode" id="cb4"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> paper_query_api(params):</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Query the Semantic Scholar API with the given query and parameters.&quot;&quot;&quot;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Request content from the API</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>        request_url <span class="op">=</span> <span class="st">&#39;https://api.semanticscholar.org/graph/v1/paper/search&#39;</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>        response <span class="op">=</span> requests.get(request_url, params<span class="op">=</span>params)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Retry requesting if rate limit is reached</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> response.status_code <span class="op">==</span> <span class="dv">429</span>:</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>            time.sleep(<span class="dv">5</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> response</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> handle_response(response):</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Handle the response from the API.&quot;&quot;&quot;</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if the response was unsuccessful</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> response.status_code <span class="op">!=</span> <span class="dv">200</span>:</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the data from the response</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> response.json()</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if the data is valid</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">&#39;data&#39;</span> <span class="kw">not</span> <span class="kw">in</span> data:</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Return the data</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> data[<span class="st">&#39;data&#39;</span>]</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> process_data(data):</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Process data gathered from API&quot;&quot;&quot;</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Rename paperId to _id for storing papers by paper ID in MongoDB</span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>    paper_batch <span class="op">=</span> [{<span class="st">&quot;_id&quot;</span>: d.pop(<span class="st">&quot;paperId&quot;</span>), <span class="op">**</span>d} <span class="cf">for</span> d <span class="kw">in</span> data]</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Only save IDs of paper references</span></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> paper <span class="kw">in</span> paper_batch:</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">&quot;references&quot;</span> <span class="kw">in</span> paper:</span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>            paper[<span class="st">&quot;references&quot;</span>] <span class="op">=</span> [ref[<span class="st">&quot;paperId&quot;</span>] <span class="cf">for</span> ref <span class="kw">in</span> paper[<span class="st">&quot;references&quot;</span>] <span class="cf">if</span> ref[<span class="st">&quot;paperId&quot;</span>] <span class="op">!=</span> <span class="va">None</span>]</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> paper_batch</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> write_to_database(paper_batch, collection):</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Write the given paper data to the database.&quot;&quot;&quot;</span></span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Write the papers to the database</span></span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> paper <span class="kw">in</span> paper_batch:</span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>            collection.insert_one(paper)</span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span>:</span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>            <span class="cf">pass</span></span></code></pre></div>
</div>
<div class="cell code" data-cell_id="b24ec6ac4b914fe6906a751a55232e1c"
data-deepnote_cell_type="code" data-deepnote_to_be_reexecuted="false"
data-execution_millis="9" data-execution_start="1683494105605"
data-source_hash="8f6d7a">
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> thread(params, shared_resources):</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;The task carried out by each process&quot;&quot;&quot;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Connect to mongoDB</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    client <span class="op">=</span> MongoClient(<span class="st">&#39;localhost&#39;</span>, <span class="dv">27017</span>) <span class="co"># Replace with address of database</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    db <span class="op">=</span> client[<span class="st">&#39;comSocDB&#39;</span>]</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    collection <span class="op">=</span> db[<span class="st">&#39;papers&#39;</span>]</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Continuing querying while there are still API pages to be processed</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> shared_resources[<span class="st">&quot;offsets_and_limits&quot;</span>]:</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Get the next offset and limit to be queried</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> shared_resources[<span class="st">&quot;params_lock&quot;</span>]:</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>            offsets_and_limits <span class="op">=</span> shared_resources[<span class="st">&quot;offsets_and_limits&quot;</span>].pop(<span class="dv">0</span>)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>            params[<span class="st">&quot;offset&quot;</span>] <span class="op">=</span> offsets_and_limits[<span class="dv">0</span>]</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>            params[<span class="st">&quot;limit&quot;</span>] <span class="op">=</span> offsets_and_limits[<span class="dv">1</span>]</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Query the API</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>        response <span class="op">=</span> paper_query_api(params)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>        data <span class="op">=</span> handle_response(response)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Split the query and add to processing que if API call failed</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> data <span class="op">==</span> <span class="va">None</span>:</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Print reason for API call failure for debugging</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;Error: </span><span class="sc">{</span>response<span class="sc">.</span>status_code<span class="sc">}</span><span class="ss"> - </span><span class="sc">{</span>response<span class="sc">.</span>text<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>            <span class="co"># If the limit is 5 or less, discard the queued request</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> params[<span class="st">&quot;limit&quot;</span>] <span class="op">&lt;=</span> <span class="dv">5</span>:</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Split API query size</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>            half_limit <span class="op">=</span> params[<span class="st">&quot;limit&quot;</span>] <span class="op">//</span> <span class="dv">2</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Add split query to queue</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> shared_resources[<span class="st">&quot;params_lock&quot;</span>]:</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>                shared_resources[<span class="st">&quot;offsets_and_limits&quot;</span>].insert(<span class="dv">0</span>, (params[<span class="st">&quot;offset&quot;</span>], half_limit))</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>                shared_resources[<span class="st">&quot;offsets_and_limits&quot;</span>].insert(<span class="dv">0</span>, (params[<span class="st">&quot;offset&quot;</span>] <span class="op">+</span> half_limit, params[<span class="st">&quot;limit&quot;</span>] <span class="op">-</span> half_limit))</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>        paper_batch <span class="op">=</span> process_data(data)</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>        write_to_database(paper_batch, collection)</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Print progress of the data collection process</span></span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(shared_resources[<span class="st">&quot;offsets_and_limits&quot;</span>]) <span class="op">%</span> <span class="dv">20</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;Missing </span><span class="sc">{</span><span class="bu">len</span>(shared_resources[<span class="st">&#39;offsets_and_limits&#39;</span>])<span class="sc">}</span><span class="ss"> queries&quot;</span>)</span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>            </span></code></pre></div>
</div>
<div class="cell markdown"
data-cell_id="b66ddeba1e194bad80fac4ecd1fb9cb1"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>The code bellow was used for gathering the data and should not be run
as it may take a while and requires a live Mongo database to be
supplied.</p>
</div>
<div class="cell code" data-cell_id="39b3e5bc52864a37874dc51a71c01448"
data-deepnote_cell_type="code">
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>exit()</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the query parameters for the API</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> {</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;query&quot;</span>: <span class="st">&quot;Artificial Intelligence&quot;</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;year&quot;</span>: <span class="dv">2023</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;sort&quot;</span>: <span class="st">&quot;relevance&quot;</span>,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;fields&quot;</span>: <span class="st">&quot;paperId,title,year,citationCount,abstract,references.paperId&quot;</span>,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>NUM_WORKERS <span class="op">=</span> <span class="dv">20</span>  <span class="co"># Number of parallel processes used</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop for each year</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> year <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2023</span>, <span class="dv">1989</span>, <span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set year</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    params[<span class="st">&quot;year&quot;</span>] <span class="op">=</span> year</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Print progress update</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;QUERY YEAR: &quot;</span>, year)</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Make a shared list of batch indicies that can be updated</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>    manager <span class="op">=</span> multiprocessing.Manager()</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>    offsets_and_limits <span class="op">=</span> manager.<span class="bu">list</span>(</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>        [(i, <span class="dv">100</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">10000</span>, <span class="dv">100</span>)]</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>    )  <span class="co"># Max query depth is 10000</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>    params_lock <span class="op">=</span> manager.Lock()  <span class="co"># Lock for writing to the shared resources</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Resources shared across processes</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>    shared_resources <span class="op">=</span> {</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;offsets_and_limits&quot;</span>: offsets_and_limits,</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;params_lock&quot;</span>: params_lock,</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Begin parallel processing</span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>    processes <span class="op">=</span> []</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(NUM_WORKERS):</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>        p <span class="op">=</span> multiprocessing.Process(target<span class="op">=</span>thread, args<span class="op">=</span>(params, shared_resources))</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>        p.start()</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>        processes.append(p)</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Wait for all the processes to complete before returning</span></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> p <span class="kw">in</span> processes:</span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>        p.join()</span></code></pre></div>
</div>
<section id="part-2---basic-stats-lets-understand-the-dataset-better"
class="cell markdown" data-cell_id="c1b72a60a7704fe09750fb49f4494fe0"
data-deepnote_cell_type="text-cell-h2" data-formattedRanges="[]">
<h2>Part 2 - Basic stats. Let’s understand the dataset better</h2>
</section>
<div class="cell markdown"
data-cell_id="1ec2a993-0788-4d78-a00b-7819740caf59"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>Now that we have constructed our database of raw data, let's
investigate and clean it based on our findings before moving on with
further analysis.</p>
</div>
<div class="cell markdown"
data-cell_id="4fb1aaaf-365a-4ec2-8830-2e644c74aa63"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>For readability we briefly present the structure of this section. We
start by inspecting our collected data as a whole, examining the number
of papers, referenced papers, and potential data issues regarding
missing values. From these findings we motivate our choice of data
cleaning. We then move on and examine the cleaned dataset grouped by
year, to examine the number of papers and references within these. From
this we decide on a yearly grouping strategy to introduce the temporal
aspect of our further analysis. Lastly we create graph representations
of these data groupings and provide an graph analysis on these.</p>
</div>
<section id="preprocessing" class="cell markdown"
data-cell_id="4d1caafd3acb431796502cea74e6d854"
data-deepnote_cell_type="markdown">
<h3>Preprocessing</h3>
<p>In order to make later analysis using TF-IDF faster, all abstracts in
the dataset are preprocessed by adding a tokenised version of the
abstract to each paper in the database. The tokenisation is based on the
NLTK word_tokenizer, which essentially just splits the document based on
white space. We then import a dicitionary of stop words, and define our
own filter on characters to further filter the tokens. This way we get a
more indicative list of words used in each abstract.</p>
</section>
<div class="cell code" data-cell_id="5e602540aab3415eb654fbb2c298c395"
data-deepnote_cell_type="code" data-deepnote_to_be_reexecuted="false"
data-execution_millis="2" data-execution_start="1683494112845"
data-source_hash="2fcb4f41">
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> tokenizer(text):</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Helper function to tokenize a text. Uses NLTK word_tokenize and stopwords, along with filtering out non-words.</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">        text (str): String to be tokenized</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co">        list: list of tokens</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    tokenized_text <span class="op">=</span> word_tokenize(text.lower())</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove all non-words and stopwords</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    stopwords_english <span class="op">=</span> <span class="bu">set</span>(stopwords.words(<span class="st">&quot;english&quot;</span>)) <span class="co">#get the stop words</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># There might be a better way to do this, but for now this will suffice.</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    filter_ <span class="op">=</span> [<span class="st">&quot;.&quot;</span>, <span class="st">&quot;,&quot;</span>, <span class="st">&quot;!&quot;</span>, <span class="st">&quot;...&quot;</span>, <span class="st">&quot;$&quot;</span>, <span class="st">&quot;(&quot;</span>, <span class="st">&quot;)&quot;</span>, <span class="st">&quot;:&quot;</span>, </span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;;&quot;</span>, <span class="st">&quot;-&quot;</span>, <span class="st">&quot;_&quot;</span>, <span class="st">&quot;*&quot;</span>, <span class="st">&#39;&quot;&#39;</span>, <span class="st">&quot;&#39;&quot;</span>, <span class="st">&quot;&amp;&quot;</span>,</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;%&quot;</span>, <span class="st">&quot;=&quot;</span>, <span class="st">&quot;#&quot;</span>, <span class="st">&quot;@&quot;</span>]</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>    tokenized_text_words <span class="op">=</span> [token <span class="cf">for</span> token <span class="kw">in</span> tokenized_text <span class="cf">if</span> token <span class="kw">not</span> <span class="kw">in</span> filter_ <span class="kw">and</span> token <span class="kw">not</span> <span class="kw">in</span> stopwords_english]</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tokenized_text_words</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
</div>
<div class="cell markdown"
data-cell_id="200dc900cd0844c2ba2cb5ebe3c868c3"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>During the project, we found that a significantly sized pool of
documents were written in non-english languages. This can degrade the
quality of the TF-IDF analysis that is to be conducted later. Therefore
a helper function to filter out non-english words is constructed.</p>
</div>
<div class="cell code" data-cell_id="a6561f5ee9464316935792d05212b734"
data-deepnote_cell_type="code" data-deepnote_to_be_reexecuted="false"
data-execution_millis="42" data-execution_start="1683494116025"
data-source_hash="c968f6d2">
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_non_english_tokens(tokens):</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Helper function to remove tokens that are not English words.</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">        tokens (list): list of tokens</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co">        list: list of tokens</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    english_words <span class="op">=</span> <span class="bu">set</span>(nltk.corpus.words.words())</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [token <span class="cf">for</span> token <span class="kw">in</span> tokens <span class="cf">if</span> token <span class="kw">in</span> english_words]</span></code></pre></div>
</div>
<div class="cell markdown"
data-cell_id="0a17577eb8a1497b81d6aeddbabf67e1"
data-deepnote_cell_type="text-cell-p"
data-formattedRanges="[{&quot;fromCodePoint&quot;:183,&quot;marks&quot;:{&quot;bold&quot;:true,&quot;underline&quot;:true},&quot;toCodePoint&quot;:200,&quot;type&quot;:&quot;marks&quot;}]">
<p>The tokenizer function is then run on the entire database. This part
is done separately from the rest of the analysis, since it is very
compute heavy. The code is provided below, but should not be run.</p>
</div>
<div class="cell code" data-cell_id="212bd61d18a4464fbbb5ea31f4727e79"
data-deepnote_cell_type="code">
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>exit()</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_collection(client <span class="op">=</span> <span class="va">None</span>):</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> client:</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>        client.close()</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    client <span class="op">=</span> MongoClient(<span class="st">&quot;mongodb+srv://augusttollerup:WywyHtYJflgqirMG@cluster0.rx8hxlc.mongodb.net/test&quot;</span>) <span class="co"># Replace with your MongoDB URL</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    db <span class="op">=</span> client[<span class="st">&#39;ComSoc&#39;</span>] <span class="co"># Replace with your database name</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    collection <span class="op">=</span> db[<span class="st">&#39;papers&#39;</span>] <span class="co"># Replace with your collection name</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># papers = collection.find({&#39;abstract&#39;: {&#39;$ne&#39;: None}, &quot;tokens&quot;: {&quot;$exists&quot;: False}})</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> collection</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>collection <span class="op">=</span> get_collection()</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co"># apply the tokenizer function to all matching rows in the collection using bulk_write</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>query <span class="op">=</span> {<span class="st">&#39;abstract&#39;</span>: {<span class="st">&#39;$ne&#39;</span>: <span class="va">None</span>}, <span class="st">&quot;tokens&quot;</span>: {<span class="st">&quot;$exists&quot;</span>: <span class="va">False</span>}}</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>batch_size <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>cursor <span class="op">=</span> collection.find(query)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>bulk_updates <span class="op">=</span> []</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(cursor):</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    tokens <span class="op">=</span> tokenizer(row[<span class="st">&quot;abstract&quot;</span>])</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    bulk_updates.append(pymongo.UpdateOne({<span class="st">&quot;_id&quot;</span>: row[<span class="st">&quot;_id&quot;</span>]}, {<span class="st">&quot;$set&quot;</span>: {<span class="st">&quot;tokens&quot;</span>: tokens}}))</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="op">%</span> batch_size <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> collection.bulk_write(bulk_updates)</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(result.modified_count, <span class="st">&quot;rows updated.&quot;</span>)</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>        bulk_updates <span class="op">=</span> []</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> bulk_updates:</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> collection.bulk_write(bulk_updates)</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(result.modified_count, <span class="st">&quot;rows updated.&quot;</span>)</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>client.close()</span></code></pre></div>
</div>
<section id="overall-data-inspection-and-cleaning" class="cell markdown"
data-cell_id="ffd3d8a15eec412089f580eba3824abb"
data-deepnote_cell_type="text-cell-h3" data-formattedRanges="[]">
<h3>Overall data inspection and cleaning</h3>
</section>
<div class="cell markdown"
data-cell_id="bea8654c-ca2f-4a17-b3f8-db87765718c0"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>Lets investigate the data as a whole. First, we connect to our
database and make a query for all data except abstracts and tokens.</p>
</div>
<div class="cell code" data-execution_count="9"
data-cell_id="3e13862893dc45cc975879ba2c25a0d8"
data-deepnote_cell_type="code" data-deepnote_to_be_reexecuted="false"
data-execution_millis="31010" data-execution_start="1683495610848"
data-source_hash="f51c946a">
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Connect to database</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>client <span class="op">=</span> MongoClient(<span class="st">&quot;mongodb+srv://augusttollerup:YLdUGXAq0l1TenD3@cluster0.rx8hxlc.mongodb.net/&quot;</span>) <span class="co"># Replace with your MongoDB URL</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>db <span class="op">=</span> client[<span class="st">&#39;ComSoc&#39;</span>] <span class="co"># Replace with your database name</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>collection <span class="op">=</span> db[<span class="st">&#39;papers&#39;</span>] <span class="co"># Replace with your collection name</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>data_minus_abstract <span class="op">=</span> pd.DataFrame(<span class="bu">list</span>(collection.find({}, {<span class="st">&#39;abstract&#39;</span>:<span class="dv">0</span>, <span class="st">&#39;tokens&#39;</span>: <span class="dv">0</span>})))</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">#data_minus_abstract = pd.DataFrame(list(collection.find({}, {&#39;tokens&#39;: 0})))</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>client.close()</span></code></pre></div>
</div>
<div class="cell markdown"
data-cell_id="6e9524b26bc24ca68839a6f7819581c6"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>Let us load the paper ids as well as the reference papers id's, and
take a look at the amount of data we have available.</p>
</div>
<div class="cell code" data-execution_count="10"
data-cell_id="53dcb2c3d5864a65b34f69d3aeb1a482"
data-deepnote_cell_type="code" data-deepnote_to_be_reexecuted="false"
data-execution_millis="1725" data-execution_start="1683495642076"
data-source_hash="96549df3">
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract paper ids and reference paper ids</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>paper_ids <span class="op">=</span> data_minus_abstract[<span class="st">&#39;_id&#39;</span>]</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>reference_paper_ids <span class="op">=</span> [ref_id <span class="cf">for</span> paper <span class="kw">in</span> data_minus_abstract[<span class="st">&#39;references&#39;</span>] <span class="cf">for</span> ref_id <span class="kw">in</span> paper]</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Number of papers: </span><span class="sc">{</span><span class="bu">len</span>(paper_ids)<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Number of referenced papers: </span><span class="sc">{</span><span class="bu">len</span>(reference_paper_ids)<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Number of referenced papers without duplicates: </span><span class="sc">{</span><span class="bu">len</span>(<span class="bu">set</span>(reference_paper_ids))<span class="sc">}</span><span class="ss">&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Number of papers: 315391
Number of referenced papers: 6568377
Number of referenced papers without duplicates: 3233444
</code></pre>
</div>
</div>
<div class="cell markdown"
data-cell_id="c3733086bf9747218acb5f1ce5d12fc4"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>As can be seen from the numbers above, we have a lot more referenced
papers than we have main papers in our dataset, even when removing
duplicates. This means that many of the papers references other papers
that have not been found within our initial search. However, the fact
that we have so many duplicates indicates community structure, as
multiple papers reference the same papers.</p>
</div>
<div class="cell markdown"
data-cell_id="fe946522-d658-4c71-a6c1-9ef48d8f7da6"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>As we need the abstracts for our later analysis, we now examine
potential issues with missing values, before moving on to a more in
depth data analysis. For this we look up the rows in the data where the
abstract is missing:</p>
</div>
<div class="cell code" data-cell_id="10c30def24024d7da6f0d8a7a78407c9"
data-deepnote_cell_type="code" data-deepnote_to_be_reexecuted="false"
data-execution_millis="9893" data-execution_start="1683494213853"
data-source_hash="f071005">
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>rows_w_missing_abstract <span class="op">=</span> mongoDB({<span class="st">&#39;abstract&#39;</span>: <span class="va">None</span>})</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>num_rows_w_missing_data <span class="op">=</span> <span class="bu">len</span>(rows_w_missing_abstract.index) </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Number of papers without abstract or with no references </span><span class="sc">{</span>num_rows_w_missing_data<span class="sc">}</span><span class="ss">&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Number of papers without abstract or with no references 66078
</code></pre>
</div>
</div>
<div class="cell markdown"
data-cell_id="dc694509-e4e6-4389-80fc-6b34012f3da9"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>We find that quite a lot of our collected papers have no abstract.
Since the abstracts are super important for our analysis we choose to
remove them from our dataset. We clean our data from missing values by
always querying with "abstract" != None, i.e. {"abstract": {"$ne":
None}}.</p>
</div>
<div class="cell code" data-execution_count="6"
data-cell_id="aef69590c6d04fd3b9acd7f5cc263171"
data-deepnote_cell_type="code" data-deepnote_to_be_reexecuted="false"
data-execution_millis="19847" data-execution_start="1683495561381"
data-source_hash="e21e5ca0">
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>query <span class="op">=</span> {<span class="st">&quot;abstract&quot;</span>: {<span class="st">&quot;$ne&quot;</span>: <span class="va">None</span>}}</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> mongoDB(query, projection<span class="op">=</span>{<span class="st">&quot;title&quot;</span>: <span class="dv">1</span>, <span class="st">&quot;year&quot;</span>: <span class="dv">1</span>, <span class="st">&quot;references&quot;</span>: <span class="dv">1</span>})</span></code></pre></div>
</div>
<div class="cell markdown"
data-cell_id="1336e748-561e-4506-9d9c-85e7c4b1661a"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>Now that we have cleaned our data from missing values, let's once
again take a look at the number of papers and referenced papers. Let's
also examine the amount of referenced papers already collected in our
main papers list.</p>
</div>
<div class="cell code" data-execution_count="11"
data-cell_id="ef15173463084ae1ab90dae691f5d253"
data-deepnote_cell_type="code" data-deepnote_to_be_reexecuted="false"
data-execution_millis="2712" data-execution_start="1683495644050"
data-source_hash="522f08f1">
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> summerize_references_in_data(data):</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Change paper dataframe to set, to get constant lookup time</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  paper_ids_set_version <span class="op">=</span> <span class="bu">set</span>(data[<span class="st">&#39;_id&#39;</span>])</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  reference_paper_ids <span class="op">=</span> [ref_id <span class="cf">for</span> paper <span class="kw">in</span> data[<span class="st">&#39;references&#39;</span>] <span class="cf">for</span> ref_id <span class="kw">in</span> paper]</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>   <span class="co"># Find the references that refer to papers that exists in the dataset</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  referenced_paper_ids_in_dataset <span class="op">=</span> []</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> reference_paper <span class="kw">in</span> tqdm(reference_paper_ids, total<span class="op">=</span><span class="bu">len</span>(reference_paper_ids)):</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> reference_paper <span class="kw">in</span> paper_ids_set_version:</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>      count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>      referenced_paper_ids_in_dataset.append(reference_paper)</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  referenced_paper_ids_in_dataset <span class="op">=</span> <span class="bu">set</span>(referenced_paper_ids_in_dataset)</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Find the papers that refer to papers that exists in the dataset</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>  referencing_paper_ids <span class="op">=</span> []</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> paper <span class="kw">in</span> tqdm(<span class="bu">zip</span>(paper_ids, data[<span class="st">&#39;references&#39;</span>]), total<span class="op">=</span><span class="bu">len</span>(data[<span class="st">&#39;_id&#39;</span>])):</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> reference_id <span class="kw">in</span> paper[<span class="dv">1</span>]:</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> reference_id <span class="kw">in</span> paper_ids_set_version:</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>          referencing_paper_ids.append(paper[<span class="dv">0</span>])</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>          <span class="cf">break</span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>  referencing_paper_ids <span class="op">=</span> <span class="bu">set</span>(referencing_paper_ids)</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Find the papers that refer to papers or are referenced by papers that exists in the dataset</span></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>  referenced_or_referencing_paper_ids_in_dataset <span class="op">=</span> referencing_paper_ids.union(referenced_paper_ids_in_dataset)</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate up summary statistics</span></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>  number_of_papers <span class="op">=</span> <span class="bu">len</span>(paper_ids_set_version)</span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>  number_of_references <span class="op">=</span> <span class="bu">len</span>(reference_paper_ids)</span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>  number_of_references_without_duplicates <span class="op">=</span> <span class="bu">len</span>(<span class="bu">set</span>(reference_paper_ids))</span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>  number_of_references_to_papers_in_dataset <span class="op">=</span> count</span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>  number_of_papers_referenced_by_papers_in_dataset <span class="op">=</span> <span class="bu">len</span>(referenced_paper_ids_in_dataset)</span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>  number_of_papers_referencing_papers_in_dataset <span class="op">=</span> <span class="bu">len</span>(referencing_paper_ids)</span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>  number_of_papers_referencing_or_referenced_by_papers_in_dataset <span class="op">=</span> <span class="bu">len</span>(referenced_or_referencing_paper_ids_in_dataset)</span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print summary statistics</span></span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="ss">f&#39;Number of papers: </span><span class="sc">{</span>number_of_papers<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="ss">f&#39;Number of references: </span><span class="sc">{</span>number_of_references<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="ss">f&#39;Number of references without duplicates: </span><span class="sc">{</span>number_of_references_without_duplicates<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="ss">f&#39;</span><span class="sc">{</span>number_of_references_to_papers_in_dataset<span class="sc">}</span><span class="ss">, or </span><span class="sc">{</span>(number_of_references_to_papers_in_dataset<span class="op">/</span>number_of_references)<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%, of the </span><span class="sc">{</span>number_of_references<span class="sc">}</span><span class="ss"> references made refer to papers in the dataset&#39;</span>)</span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="ss">f&#39;</span><span class="sc">{</span>number_of_papers_referenced_by_papers_in_dataset<span class="sc">}</span><span class="ss">, or </span><span class="sc">{</span>(number_of_papers_referenced_by_papers_in_dataset<span class="op">/</span>number_of_papers)<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%, of the </span><span class="sc">{</span>number_of_papers<span class="sc">}</span><span class="ss"> papers are referenced by another paper in the dataset&#39;</span>)</span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="ss">f&#39;</span><span class="sc">{</span>number_of_papers_referencing_papers_in_dataset<span class="sc">}</span><span class="ss">, or </span><span class="sc">{</span>(number_of_papers_referencing_papers_in_dataset<span class="op">/</span>number_of_papers)<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%, of the </span><span class="sc">{</span>number_of_papers<span class="sc">}</span><span class="ss"> papers reference another paper in the dataset&#39;</span>)</span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="ss">f&#39;</span><span class="sc">{</span>number_of_papers_referencing_or_referenced_by_papers_in_dataset<span class="sc">}</span><span class="ss">, or </span><span class="sc">{</span>(number_of_papers_referencing_or_referenced_by_papers_in_dataset<span class="op">/</span>number_of_papers)<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%, of the </span><span class="sc">{</span>number_of_papers<span class="sc">}</span><span class="ss"> papers reference or are referenced by another paper in the dataset&#39;</span>)</span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> referenced_or_referencing_paper_ids_in_dataset</span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a>referenced_or_referencing_paper_ids_in_dataset <span class="op">=</span> summerize_references_in_data(data)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>100%|██████████| 4922432/4922432 [00:01&lt;00:00, 3613178.03it/s]
100%|██████████| 249313/249313 [00:00&lt;00:00, 645800.98it/s]
Number of papers: 249313
Number of references: 4922432
Number of references without duplicates: 2638163
316668, or 6.43%, of the 4922432 references made refer to papers in the dataset
75816, or 30.41%, of the 249313 papers are referenced by another paper in the dataset
93641, or 37.56%, of the 249313 papers reference another paper in the dataset
145918, or 58.53%, of the 249313 papers reference or are referenced by another paper in the dataset
</code></pre>
</div>
</div>
<div class="cell markdown"
data-cell_id="18c38aa8-326f-4bc5-9703-0ba6a334ce4d"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>We still have quite a lot of papers, and a lot more referenced
papers. We find that only 316.668 or 6.43% of the 4.922.432 references
refer to papers that already exist in our dataset. This corresponds to
the total number of edges in a graph constructed over the entire
dataset. We could choose to make a query for these papers and add them
to our dataset, however as they may not be relevant to the main task,
and due to the fact that we already have enough data to carry out our
analysis, these references are ignored. It is also worth noting that
only 30.41% of the papers in the dataset is referenced by one or more
other papers present in the graph, while 37.56% make a reference to one
or more papers in the graph. In total, 50.08% of the papers either
reference another paper in the dataset or are referenced by one. Thus
half of the nodes (i.e. papers) from the dataset participate in a link,
which should be enough to find some interesting graphs to work with.</p>
</div>
<div class="cell markdown"
data-cell_id="0c01df90-8799-49bf-bcb3-571d5ae78864"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>Let's also investigate the number of papers and referenced papers
within each year in our cleaned dataset.</p>
</div>
<div class="cell code" data-cell_id="7b0e9be2b117435da76a65a345400586"
data-deepnote_cell_type="code" data-deepnote_to_be_reexecuted="false"
data-execution_millis="122" data-execution_start="1683494262526"
data-source_hash="17a9c56">
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>data_by_year <span class="op">=</span> []</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> year <span class="kw">in</span> np.unique(data[<span class="st">&#39;year&#39;</span>]):</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    data_by_year.append(data[data[<span class="st">&#39;year&#39;</span>] <span class="op">==</span> year])</span></code></pre></div>
</div>
<div class="cell code" data-cell_id="5c3d040d09a344bb82f9112804241964"
data-deepnote_cell_type="code" data-deepnote_to_be_reexecuted="false"
data-execution_millis="70" data-execution_start="1683494264314"
data-source_hash="59f55a17">
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="bu">min</span>(np.unique(data[<span class="st">&#39;year&#39;</span>])), <span class="bu">max</span>(np.unique(data[<span class="st">&#39;year&#39;</span>])<span class="op">+</span><span class="dv">1</span>))</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> [<span class="bu">len</span>(df.index) <span class="cf">for</span> df <span class="kw">in</span> data_by_year]</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>plt.bar(x,y)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&quot;Year&quot;</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&quot;Number of papers&quot;</span>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Number of Papers by Year in Cleaned Dataset&quot;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="16">
<pre><code>Text(0.5, 1.0, &#39;Number of Papers by Year in Cleaned Dataset&#39;)</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_9447875aee7648dcaa153aef3c707f9d/ec826670ad7b6bc37a51dcb80b1a8d9c9f65e595.png"
width="577" height="455" /></p>
</div>
</div>
<div class="cell markdown"
data-cell_id="20c82d2b-8395-437c-b05a-f5eac1d2262c"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>As seen from the plot above, the amount of papers in our cleaned
dataset seem to be roughly equally spread out throughout the years,
which is definately a nice property for our analysis. We group these
years by decades and carry out our analysis with respect to these
decades. As such, we group the papers by four decades: [1990-1999],
[2000-2009], [2010-2019] and [2020-present].</p>
</div>
<div class="cell code" data-cell_id="f6d8ae7e599e40b4a8c6372ce536867f"
data-deepnote_cell_type="code" data-deepnote_to_be_reexecuted="false"
data-execution_millis="202" data-execution_start="1683494271334"
data-source_hash="cdcec51f">
<div class="sourceCode" id="cb21"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>y_r <span class="op">=</span> [<span class="bu">sum</span>(y[:<span class="dv">10</span>]), <span class="bu">sum</span>(y[<span class="dv">10</span>:<span class="dv">20</span>]), <span class="bu">sum</span>(y[<span class="dv">20</span>:<span class="dv">30</span>]), <span class="bu">sum</span>(y[<span class="dv">30</span>:])]</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>plt.bar([<span class="st">&quot;1990-1999&quot;</span>, <span class="st">&quot;2000-2009&quot;</span>, <span class="st">&quot;2010-2019&quot;</span>, <span class="st">&quot;2020-present&quot;</span>],y_r)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&quot;Time Window&quot;</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&quot;Number of papers&quot;</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Number of Papers by decade&quot;</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9447875aee7648dcaa153aef3c707f9d/226b9d754926a19ffdbdaf7124ad7676ff3fa3d2.png"
width="589" height="455" /></p>
</div>
</div>
<div class="cell markdown"
data-cell_id="da4525f9-574b-47e8-84c5-4e69661739ab"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>It should not come as a surprise that the last decade contains much
fewer papers, as it is not finished as of the making of this project.
This fact will be kept in mind during the analysis. In a sense, the
split by decade is arbitrary, and we expect to loose a lot of links
(i.e. references) by building the graphs by decades. In order to get a
sense of the magnitude of this loss, the assortativity with respect to
decade is analysed. Thus a high assortativity would indicate that
references mostly exist within decades, and not a lot of links are
discarded from the analysis and vice versa for low assortativity. It is
important note that assortativity is used rather than the fraction of
edges that link two papers from the same decade, as assortativity
captures the general tendency with invariance towards unbalances in the
number of nodes with each variation of the attribute such as there being
less papers in the latest decade compared to the other decades.</p>
</div>
<div class="cell code" data-execution_count="12"
data-cell_id="471790eff8304a04840708dc9059e6a3"
data-deepnote_cell_type="code" data-deepnote_to_be_reexecuted="false"
data-execution_millis="29357" data-execution_start="1683495646764"
data-source_hash="453bc08b">
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>all_years_graph_data <span class="op">=</span> mongoDB(query <span class="op">=</span> {<span class="st">&#39;abstract&#39;</span>: {<span class="st">&#39;$ne&#39;</span>: <span class="va">None</span>}}, projection <span class="op">=</span> {<span class="st">&quot;_id&quot;</span>: <span class="dv">1</span>, <span class="st">&quot;references&quot;</span>: <span class="dv">1</span>, <span class="st">&quot;year&quot;</span>: <span class="dv">1</span>})</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>all_years_graph_data <span class="op">=</span> all_years_graph_data[all_years_graph_data[<span class="st">&#39;_id&#39;</span>].isin(referenced_or_referencing_paper_ids_in_dataset)]</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>map_year_to_decade_index <span class="op">=</span> <span class="kw">lambda</span> year: (year <span class="op">-</span> <span class="dv">1990</span>) <span class="op">//</span> <span class="dv">10</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>all_years_graph_data[<span class="st">&quot;decade&quot;</span>] <span class="op">=</span> all_years_graph_data[<span class="st">&quot;year&quot;</span>].<span class="bu">apply</span>(map_year_to_decade_index)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>node_attrs <span class="op">=</span> [(paper_id, {<span class="st">&#39;decade&#39;</span>: decade}) <span class="cf">for</span> paper_id, decade <span class="kw">in</span> <span class="bu">zip</span>(all_years_graph_data[<span class="st">&#39;_id&#39;</span>], all_years_graph_data[<span class="st">&#39;decade&#39;</span>])]</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>all_years_graph <span class="op">=</span> nx.Graph()</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>all_years_graph.add_nodes_from(node_attrs)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>edges_to_add <span class="op">=</span> []</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _, row <span class="kw">in</span> all_years_graph_data.iterrows():</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>     <span class="cf">for</span> reference_paper <span class="kw">in</span> row[<span class="st">&#39;references&#39;</span>]:</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>         <span class="cf">if</span> reference_paper <span class="kw">in</span> referenced_or_referencing_paper_ids_in_dataset:</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>             edges_to_add.append((row[<span class="st">&#39;_id&#39;</span>], reference_paper))</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>all_years_graph.add_edges_from(edges_to_add)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="13"
data-cell_id="3ebf876fbe094523acad8a651d852b64"
data-deepnote_cell_type="code" data-deepnote_to_be_reexecuted="false"
data-execution_millis="710" data-execution_start="1683495676147"
data-source_hash="d821d61a">
<div class="sourceCode" id="cb23"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>assortativity_obs <span class="op">=</span> nx.attribute_assortativity_coefficient(all_years_graph, <span class="st">&#39;decade&#39;</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The assortativity of the graph of all years is with respect to decade is: &quot;</span>, assortativity_obs)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>The assortativity of the graph of all years is with respect to decade is:  0.18158104942829725
</code></pre>
</div>
</div>
<div class="cell markdown"
data-cell_id="65c16d083d014761810767cc664434b2"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>It is hard to interpret a result as the one stated above without
context. To add some context, the statistic is bootstrapped by
shuffeling the attributes in the graph and calculating the bootstrapped
assortativities.</p>
</div>
<div class="cell code" data-execution_count="15"
data-cell_id="77ea6f596a8043579b652940133c0f0b"
data-deepnote_cell_type="code" data-deepnote_to_be_reexecuted="false"
data-execution_millis="283786" data-execution_start="1683495747489"
data-source_hash="cb03b803">
<div class="sourceCode" id="cb25"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> make_new_shuffled_graph(G):</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find attribute dict prior to shuffle</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    attributes_before <span class="op">=</span> nx.get_node_attributes(G, <span class="st">&#39;decade&#39;</span>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Shuffle attribute</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    shuffled_attributes <span class="op">=</span> random.sample(<span class="bu">list</span>(attributes_before.values()), <span class="bu">len</span>(attributes_before))</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Make new attribute dict</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    new_attribute_dict <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(attributes_before, shuffled_attributes))</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update attribute of G to shuffled version</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>    nx.set_node_attributes(G, new_attribute_dict, <span class="st">&#39;decade&#39;</span>)</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> G</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Save average fractions found</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>assortativities <span class="op">=</span> []</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> tqdm(<span class="bu">range</span>(<span class="dv">100</span>)):</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generate a new graph with shuffled field attribute    </span></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>    G_shuffle <span class="op">=</span> make_new_shuffled_graph(all_years_graph.copy())</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate fraction and add to fractions</span></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>    assortativities.append(nx.attribute_assortativity_coefficient(G_shuffle, <span class="st">&#39;decade&#39;</span>))</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The average of the assortativities from bootstrapping is: &quot;</span>, np.mean(assortativities))</span></code></pre></div>
<div class="output stream stderr">
<pre><code>100%|██████████| 100/100 [04:43&lt;00:00,  2.84s/it]The average of the assortativities from bootstrapping is:  -0.0066920234153897895

</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="16"
data-cell_id="60065aea200d4b36bf49202ce6ea174e"
data-deepnote_cell_type="code" data-deepnote_to_be_reexecuted="false"
data-execution_millis="298" data-execution_start="1683496031280"
data-source_hash="ebac5f3b">
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot bootstrap distribution of average fraction</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>bins <span class="op">=</span> np.linspace(np.<span class="bu">min</span>(assortativities),np.<span class="bu">max</span>(assortativities), <span class="dv">30</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>hist, edges <span class="op">=</span> np.histogram(assortativities, bins <span class="op">=</span> bins, density<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> (edges[<span class="dv">1</span>:] <span class="op">+</span> edges[:<span class="op">-</span><span class="dv">1</span>])<span class="op">/</span><span class="dv">2</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>width <span class="op">=</span> bins[<span class="dv">1</span>]<span class="op">-</span>bins[<span class="dv">0</span>]</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>ax.bar(x,hist, width <span class="op">=</span> <span class="fl">.9</span><span class="op">*</span>width, label<span class="op">=</span><span class="st">&quot;Bootstrap distribution of assortativity&quot;</span>)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="co">#ax.axvline(x=assortativity_obs, color=&#39;r&#39;, label=&quot;Observed assortativity&quot;)</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="st">&quot;upper right&quot;</span>)</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">&#39;Bootstrapped assortativity&#39;</span>)</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">&#39;Probability Density&#39;</span>)</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">&#39;Bootstrap distribution of assortativity of the graph of all years with respect to decade&#39;</span>)</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;p-value from bootstrap: &quot;</span>, np.mean(assortativities <span class="op">&gt;</span> assortativity_obs) <span class="op">*</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9447875aee7648dcaa153aef3c707f9d/6a6f5fd47d08dafc8e26a1f096ffa3508e1a3654.png"
width="730" height="455" /></p>
</div>
<div class="output stream stdout">
<pre><code>p-value from bootstrap:  0.0
</code></pre>
</div>
</div>
<div class="cell markdown"
data-cell_id="4dfb77a48b694016ad448e3e6e5c4a17"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>No calculations are needed in order to see that the calculated
assortativity is very significant (hence the p-value of 0) which
indicates that there definitely is a tendency for the papers to
reference papers from within the same decade. This should not come as a
surprise as research tends to built on top of recent knowledge. Thus the
observed assortativity indicates that we can still expect to keep some
structure of the dataset after splitting the dataset by decades.
However, the assortativity of the graph is far from perfect, which means
that a lot of links are lost by splitting the data by decades.</p>
</div>
<div class="cell markdown"
data-cell_id="3e30e33311c7485682be4c0b05ca545c"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>Before we start making graph representations for each decade, let's
just examine the number of referenced papers in each decade included in
the analysis.</p>
</div>
<div class="cell code" data-cell_id="6dd4656b728d4d3fbc984acea3786a90"
data-deepnote_cell_type="code" data-deepnote_to_be_reexecuted="false"
data-execution_millis="30150" data-execution_start="1683494400613"
data-source_hash="5b696118">
<div class="sourceCode" id="cb29"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>decade_data <span class="op">=</span> [mongoDB(query <span class="op">=</span> {<span class="st">&#39;abstract&#39;</span>: {<span class="st">&#39;$ne&#39;</span>: <span class="va">None</span>}, <span class="st">&#39;year&#39;</span>: {<span class="st">&#39;$gte&#39;</span>: <span class="dv">1990</span> <span class="op">+</span> i <span class="op">*</span> <span class="dv">10</span>, <span class="st">&quot;$lte&quot;</span>: <span class="dv">1999</span> <span class="op">+</span> i <span class="op">*</span> <span class="dv">10</span>}}, projection <span class="op">=</span> {<span class="st">&quot;_id&quot;</span>: <span class="dv">1</span>, <span class="st">&quot;references&quot;</span>: <span class="dv">1</span>}) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">4</span>)]</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, data_for_one_decade <span class="kw">in</span> <span class="bu">enumerate</span>(decade_data):</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;&quot;</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;-------- Summary for </span><span class="sc">{}</span><span class="st">s&quot;</span>.<span class="bu">format</span>(<span class="dv">1990</span> <span class="op">+</span> i <span class="op">*</span> <span class="dv">10</span>), <span class="st">&quot;--------&quot;</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    summerize_references_in_data(data_for_one_decade)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>
-------- Summary for 1990s --------
100%|██████████| 753711/753711 [00:00&lt;00:00, 3158781.83it/s]
100%|██████████| 73948/73948 [00:00&lt;00:00, 597352.58it/s]
Number of papers: 73948
Number of references: 753711
Number of references without duplicates: 503727
25726, or 3.41%, of the 753711 references made refer to papers in the dataset
10506, or 14.21%, of the 73948 papers are referenced by another paper in the dataset
12592, or 17.03%, of the 73948 papers reference another paper in the dataset
23098, or 31.24%, of the 73948 papers reference or are referenced by another paper in the dataset

-------- Summary for 2000s --------
100%|██████████| 1350603/1350603 [00:00&lt;00:00, 3152188.85it/s]
100%|██████████| 78770/78770 [00:00&lt;00:00, 630441.38it/s]
Number of papers: 78770
Number of references: 1350603
Number of references without duplicates: 837221
44258, or 3.28%, of the 1350603 references made refer to papers in the dataset
15265, or 19.38%, of the 78770 papers are referenced by another paper in the dataset
18394, or 23.35%, of the 78770 papers reference another paper in the dataset
33659, or 42.73%, of the 78770 papers reference or are referenced by another paper in the dataset

-------- Summary for 2010s --------
100%|██████████| 1809236/1809236 [00:00&lt;00:00, 3811775.16it/s]
100%|██████████| 71589/71589 [00:00&lt;00:00, 592329.48it/s]
Number of papers: 71589
Number of references: 1809236
Number of references without duplicates: 1071107
50914, or 2.81%, of the 1809236 references made refer to papers in the dataset
18633, or 26.03%, of the 71589 papers are referenced by another paper in the dataset
21248, or 29.68%, of the 71589 papers reference another paper in the dataset
38847, or 54.26%, of the 71589 papers reference or are referenced by another paper in the dataset

-------- Summary for 2020s --------
100%|██████████| 1008882/1008882 [00:00&lt;00:00, 3444682.17it/s]
100%|██████████| 25006/25006 [00:00&lt;00:00, 537009.38it/s]
Number of papers: 25006
Number of references: 1008882
Number of references without duplicates: 647520
21988, or 2.18%, of the 1008882 references made refer to papers in the dataset
8081, or 32.32%, of the 25006 papers are referenced by another paper in the dataset
8111, or 32.44%, of the 25006 papers reference another paper in the dataset
14850, or 59.39%, of the 25006 papers reference or are referenced by another paper in the dataset
</code></pre>
</div>
</div>
<div class="cell markdown"
data-cell_id="1b899ca6-992b-44e6-b78c-7b01528bba70"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>As seen above, we have gone from having one graph with 124.845 papers
participating in a reference link to having four graphs with at total of
23.098 + 33.659 + 37.492 + 12.881 = 107.130 nodes. After splitting up
the data, (25726 + 44258 + 50914 + 21988) / 316668 = 45.12% of the links
are still present, which should be plenty for making interesting graphs
during our analysis. Though only a portion of the papers in each decade
are referenced by another paper from the same decade, we would expect to
find many small components and singletons in the dataset. These
components are not of great interest by themselves as they do not
contribute to the greater structures, but they still provide text that
is useful for the TF-IDF analysis.</p>
</div>
<section id="initial-graph-analysis" class="cell markdown"
data-cell_id="8f3ce63cf38e4f2e99f018728dde53ef"
data-deepnote_cell_type="text-cell-h3" data-formattedRanges="[]">
<h3>Initial Graph Analysis</h3>
</section>
<div class="cell markdown"
data-cell_id="fece234c-bc34-404b-85c7-87bc7d057386"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>Now that we have presented our data gathering and cleaning we move on
and create graph representations for each decade. Following this we
provide a brief preliminary analysis of the graphs before moving on with
the main analysis of the project.</p>
</div>
<div class="cell markdown"
data-cell_id="7c8bad26-4000-4a96-a744-51693121d928"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>Let's build some graphs! :-) To avoid repetitive work, we'll first
define a helper function to build the graphs given a list of years to
include. For later use, we will store the citation count of each paper
as a node attribute.</p>
</div>
<div class="cell code" data-cell_id="e608ba7ffc2b48819d56f7cc98700fed"
data-deepnote_cell_type="code" data-deepnote_to_be_reexecuted="false"
data-execution_millis="3" data-execution_start="1683494441734"
data-source_hash="7ae9e843">
<div class="sourceCode" id="cb31"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> graphmaker3000(years: <span class="bu">list</span> <span class="op">=</span> [<span class="dv">2022</span>,<span class="dv">2023</span>]):</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Helper Function to build a graph based on an interval of years.</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize graph</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    G <span class="op">=</span> nx.Graph()</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define query</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    client, collection <span class="op">=</span> mongoclient()</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>    query<span class="op">=</span>{<span class="st">&quot;abstract&quot;</span>: { <span class="st">&quot;$ne&quot;</span>: <span class="va">None</span>},</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;year&quot;</span>: {<span class="st">&#39;$in&#39;</span> : years}}</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>    projection <span class="op">=</span> {<span class="st">&quot;_id&quot;</span>: <span class="dv">1</span>, <span class="st">&quot;references&quot;</span>: <span class="dv">1</span>, <span class="st">&quot;citationCount&quot;</span>: <span class="dv">1</span>}</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Call database</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>    papers <span class="op">=</span> <span class="bu">list</span>(collection.find(query, projection))</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract all paper id&#39;s in the period</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>    paper_ids <span class="op">=</span> <span class="bu">set</span>([paper[<span class="st">&#39;_id&#39;</span>] <span class="cf">for</span> paper <span class="kw">in</span> papers])</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract all reference papers for each dataset</span></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>    reference_paper_ids <span class="op">=</span> [ref_id <span class="cf">for</span> paper <span class="kw">in</span> papers <span class="cf">for</span> ref_id <span class="kw">in</span> paper[<span class="st">&#39;references&#39;</span>]]</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Attribute dic to add later</span></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>    attrs <span class="op">=</span> {}</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Gather only reference paper ids we have in the dataset</span></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>    reference_paper_ids_in_dataset <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> reference_paper <span class="kw">in</span> reference_paper_ids:</span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> reference_paper <span class="kw">in</span> paper_ids:</span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>            reference_paper_ids_in_dataset.add(reference_paper)</span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create list of edges from papers to referenced papers</span></span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>    edges_to_add <span class="op">=</span> []</span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> paper <span class="kw">in</span> papers:</span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> reference_paper <span class="kw">in</span> paper[<span class="st">&#39;references&#39;</span>]:</span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> reference_paper <span class="kw">in</span> reference_paper_ids_in_dataset:</span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a>                edges_to_add.append((paper[<span class="st">&#39;_id&#39;</span>], reference_paper))</span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Add paper citation count to attribute dictionary</span></span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a>        attrs[paper[<span class="st">&#39;_id&#39;</span>]] <span class="op">=</span> {<span class="st">&quot;citationCount&quot;</span>:paper[<span class="st">&#39;citationCount&#39;</span>]}</span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a>    G.add_edges_from(edges_to_add)</span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a>    nx.set_node_attributes(G,attrs)</span>
<span id="cb31-46"><a href="#cb31-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-47"><a href="#cb31-47" aria-hidden="true" tabindex="-1"></a>    client.close()</span>
<span id="cb31-48"><a href="#cb31-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> G</span></code></pre></div>
</div>
<div class="cell markdown"
data-cell_id="129285804e97430ea74ee31517b12eff"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>We now utilize this helper method to create a graph for each time
window.</p>
</div>
<div class="cell code" data-cell_id="d81ba4bba6eb47839362a6ca935a8491"
data-deepnote_cell_type="code" data-deepnote_to_be_reexecuted="false"
data-execution_millis="29918" data-execution_start="1683494445286"
data-source_hash="6fd5b15e">
<div class="sourceCode" id="cb32"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># list to store the graphs</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>graphs <span class="op">=</span> []</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Lets create a list of years corresponding for each decade</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>years_list <span class="op">=</span> []</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1990</span>, <span class="dv">2023</span>, <span class="dv">10</span>):</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    years_list.append([i<span class="op">+</span>j <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>)])</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Now we create the graph</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> years <span class="kw">in</span> years_list:</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Making graph for years </span><span class="sc">{</span>years<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    graphs.append(graphmaker3000(years<span class="op">=</span>years))</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Successfully made graph</span><span class="ch">\n</span><span class="ss">&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Making graph for years [1990, 1991, 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999]
Successfully made graph

Making graph for years [2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009]
Successfully made graph

Making graph for years [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019]
Successfully made graph

Making graph for years [2020, 2021, 2022, 2023, 2024, 2025, 2026, 2027, 2028, 2029]
Successfully made graph

</code></pre>
</div>
</div>
<div class="cell markdown"
data-cell_id="6500b93a64394350be4c6dc9f15373ee"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>We note that the last print statement says 2020-2029, although this
of course only refers to the 4 years covered in our data. Now that we
have made our graphs, let us take a quick look at summary statistics for
each graph to make sure nothing seems entirely wrong.</p>
</div>
<div class="cell code" data-cell_id="b507b2e2313c45779c651e138abed8c8"
data-deepnote_cell_type="code" data-deepnote_to_be_reexecuted="false"
data-execution_millis="81" data-execution_start="1683494573179"
data-source_hash="2fe52c9c">
<div class="sourceCode" id="cb34"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> index, graph <span class="kw">in</span> <span class="bu">enumerate</span>(graphs):</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;------ Summary Statistics for Graph </span><span class="sc">{</span>index<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss"> ---------&quot;</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Number of nodes: </span><span class="sc">{</span>graph<span class="sc">.</span>number_of_nodes()<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Number of edges: </span><span class="sc">{</span>graph<span class="sc">.</span>number_of_edges()<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    degrees <span class="op">=</span> <span class="bu">list</span>(<span class="bu">dict</span>(graph.degree()).values())</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    mean_degree <span class="op">=</span> np.mean(degrees)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>    median_degree <span class="op">=</span> np.median(degrees)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Mean degree: </span><span class="sc">{</span>mean_degree<span class="sc">:.2f}</span><span class="ss">&quot;</span>)</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Median degree:&quot;</span>, median_degree)</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Min degree: </span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">min</span>(degrees)<span class="sc">:.2f}</span><span class="ss">&quot;</span>)</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Max degree:&quot;</span>, np.<span class="bu">max</span>(degrees), <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>------ Summary Statistics for Graph 1 ---------
Number of nodes: 19427
Number of edges: 25538
Mean degree: 2.63
Median degree: 2.0
Min degree: 1.00
Max degree: 152 

------ Summary Statistics for Graph 2 ---------
Number of nodes: 27399
Number of edges: 43972
Mean degree: 3.21
Median degree: 2.0
Min degree: 1.00
Max degree: 287 

------ Summary Statistics for Graph 3 ---------
Number of nodes: 31931
Number of edges: 50658
Mean degree: 3.17
Median degree: 2.0
Min degree: 1.00
Max degree: 151 

------ Summary Statistics for Graph 4 ---------
Number of nodes: 12881
Number of edges: 21919
Mean degree: 3.40
Median degree: 2.0
Min degree: 1.00
Max degree: 106 

</code></pre>
</div>
</div>
<div class="cell markdown"
data-cell_id="991a45ceee63491a9c5e10f588472b7b"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>We see that all graphs have quite many nodes and edges as we would
expect. We do see an increase in the number of nodes and edges
throughout the decades, even for the last interval when corrected for
the missing number of years. In terms of the degree distribution, we
find that all of the graphs have similar mean and median degrees that
are much lower than the maximum degree value indicating a right
tail.</p>
</div>
<div class="cell markdown"
data-cell_id="c96bc5e8-b05c-4e78-9285-f898880fe13b"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>Below we plot the distribution of the degrees for all four graphs. We
note that in our first set of plots, we clip the x-axis to better
visualize the specific values. We could of course have plottet the
distribution on a log-log scale to better show the distribution in its
entirety, but we choose to keep it as it is, since we want to
intuitively show the reader the specific counts of each degree value
throughout the graphs.</p>
</div>
<div class="cell code" data-cell_id="70ac4e9c9f6143eb83d991fa335e6bd3"
data-deepnote_cell_type="code" data-deepnote_to_be_reexecuted="false"
data-execution_millis="1111" data-execution_start="1683494826771"
data-source_hash="ad6878ff">
<div class="sourceCode" id="cb36"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> networkx <span class="im">as</span> nx</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create four graphs (in this example, random graphs)</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>G1 <span class="op">=</span> graphs[<span class="dv">0</span>]</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>G2 <span class="op">=</span> graphs[<span class="dv">1</span>]</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>G3 <span class="op">=</span> graphs[<span class="dv">2</span>]</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>G4 <span class="op">=</span> graphs[<span class="dv">3</span>]</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the degree distributions for each graph</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>degrees1 <span class="op">=</span> nx.degree_histogram(G1)</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>degrees2 <span class="op">=</span> nx.degree_histogram(G2)</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>degrees3 <span class="op">=</span> nx.degree_histogram(G3)</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>degrees4 <span class="op">=</span> nx.degree_histogram(G4)</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a><span class="co"># create a figure with a 2x2 subplot grid</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize <span class="op">=</span> (<span class="dv">20</span>,<span class="dv">10</span>))</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the degree distributions on each subplot and set axis labels</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, ax <span class="kw">in</span> <span class="bu">enumerate</span>(axs.flatten()):</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>        ax.bar(<span class="bu">range</span>(<span class="bu">len</span>(degrees1)), degrees1)</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>        ax.set_title(<span class="st">&#39;1990-1999&#39;</span>)</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> i <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>        ax.bar(<span class="bu">range</span>(<span class="bu">len</span>(degrees2)), degrees2)</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>        ax.set_title(<span class="st">&#39;2000-2009&#39;</span>)</span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> i <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>        ax.bar(<span class="bu">range</span>(<span class="bu">len</span>(degrees3)), degrees3)</span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>        ax.set_title(<span class="st">&#39;2010-2019&#39;</span>)</span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>        ax.bar(<span class="bu">range</span>(<span class="bu">len</span>(degrees4)), degrees4)</span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>        ax.set_title(<span class="st">&#39;2020-2023&#39;</span>)</span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">&#39;Degree&#39;</span>)   </span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">&#39;Count&#39;</span>)</span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a>    ax.set_ylim(<span class="dv">0</span>,<span class="dv">15000</span>)</span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a>    ax.set_xlim(<span class="dv">0</span>,<span class="dv">30</span>)</span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">&#39;Degree Distributions&#39;</span>)</span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(hspace<span class="op">=</span><span class="fl">0.2</span>, wspace<span class="op">=</span><span class="fl">0.2</span>)</span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9447875aee7648dcaa153aef3c707f9d/18ab9eec0bd8d742511c052f88ab541f1c700fda.png"
width="1651" height="933" /></p>
</div>
</div>
<div class="cell markdown"
data-cell_id="6150fdf0-50bc-4ada-851c-d314169bb59f"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>As expected from the summary statistics, we find that the structure
of all the networks seem to follow the power law with most nodes having
a small degree and a rapidly decreasing amount of nodes having larger
degrees.</p>
</div>
<section id="part-3---tools-theory-and-analysis" class="cell markdown"
data-cell_id="2f5e48ed59754b6e9da602d2ab848822"
data-deepnote_cell_type="text-cell-h2" data-formattedRanges="[]">
<h2>Part 3 - Tools, theory and analysis.</h2>
</section>
<div class="cell markdown"
data-cell_id="b34f1e0a-9f70-4046-992c-6ef3119ebff5"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>Now that we have gathered our dataset, cleaned and preprocessed it,
and made graph representations for each decade, we move on with the
actual analysis.</p>
</div>
<section id="graph-analysis" class="cell markdown"
data-cell_id="13e800ebe3d649f597593797adc67574"
data-deepnote_cell_type="text-cell-h2" data-formattedRanges="[]">
<h2>Graph analysis</h2>
</section>
<div class="cell markdown"
data-cell_id="a49022ea-1705-4735-a2ff-874952ad27fa"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>Let's recall our goal of this project; to investigate how the field
of AI evolves over time. For this we start by investigating both the
modularity of the louvain split as well as the temporal evolution in the
relative sizes of the largest communities from this partitioning
throughout the decades.</p>
</div>
<div class="cell markdown"
data-cell_id="45bf3645-45bd-467f-a05c-40fec1422996"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>For this we start by extracting the largest connected component of
each decade graph. From this we split the giant components based on the
louvain partition, compute the modularity and extract the three largest
communities.</p>
</div>
<div class="cell code" data-cell_id="1f333f128a48440cba4d2d0eaedf4b35"
data-deepnote_cell_type="code" data-deepnote_to_be_reexecuted="false"
data-execution_millis="4" data-execution_start="1683494480181"
data-source_hash="acb856e1">
<div class="sourceCode" id="cb37"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mini_graphalyser(graphs: <span class="bu">list</span>, only_paint_top_3 <span class="op">=</span> <span class="va">False</span>):</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">&#39;&#39;&#39;</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Analyses each graph in a list of graphs, by:</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co">        1) Extracting the largest connected component</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="co">        2) Computing the louvain split of the largest connected component</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="co">        3) Computing the modularity of the louvain split</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="co">        4) Extracts the largest 3 communities of the louvain split</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="co">    &#39;&#39;&#39;</span>    </span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> []</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Analysing </span><span class="sc">{</span><span class="bu">len</span>(graphs)<span class="sc">}</span><span class="ss"> graphs&quot;</span>)</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="dv">30</span><span class="op">*</span><span class="st">&quot;-&quot;</span>)</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx, G <span class="kw">in</span> <span class="bu">enumerate</span>(graphs):</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Extracting largest connected component</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Analyzing Graph </span><span class="sc">{</span>idx<span class="sc">}</span><span class="ss">:&quot;</span>)</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;Extracting largest connected component...&quot;</span>)</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>        ccs <span class="op">=</span> [G.subgraph(cc).copy() <span class="cf">for</span> cc <span class="kw">in</span> <span class="bu">sorted</span>(nx.connected_components(G), key<span class="op">=</span><span class="bu">len</span>, reverse<span class="op">=</span><span class="va">True</span>)]</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>        largest_cc <span class="op">=</span> ccs[<span class="dv">0</span>]</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&#39;Nodes in Largest Connected Component in Graph </span><span class="sc">{</span>idx<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>largest_cc<span class="sc">.</span>number_of_nodes()<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Partitioning graph with louvain algorithm</span></span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;Calculating louvain split...&quot;</span>)</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>        louvain_partition_og <span class="op">=</span> best_partition(largest_cc)</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>        groups <span class="op">=</span> {value: [key <span class="cf">for</span> key, val <span class="kw">in</span> louvain_partition_og.items() <span class="cf">if</span> val <span class="op">==</span> value] <span class="cf">for</span> value <span class="kw">in</span> <span class="bu">set</span>(louvain_partition_og.values())}</span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>        louvain_partition <span class="op">=</span> <span class="bu">list</span>(groups.values())</span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;Made partition&quot;</span>)</span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Computing modularity of louvain split</span></span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>        modularity <span class="op">=</span> nx.community.modularity(largest_cc, louvain_partition)</span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&#39;Modularity of Louvain Split: </span><span class="sc">{</span>modularity<span class="sc">:.2f}</span><span class="ss">&#39;</span>)</span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Setting community attributes</span></span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> only_paint_top_3:</span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">&quot;Setting community attribute for all nodes in connected component...&quot;</span>)</span>
<span id="cb37-38"><a href="#cb37-38" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Set the group attribute of the graph</span></span>
<span id="cb37-39"><a href="#cb37-39" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> node <span class="kw">in</span> largest_cc.nodes():</span>
<span id="cb37-40"><a href="#cb37-40" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Find community in which the node exist</span></span>
<span id="cb37-41"><a href="#cb37-41" aria-hidden="true" tabindex="-1"></a>                key <span class="op">=</span> <span class="va">None</span></span>
<span id="cb37-42"><a href="#cb37-42" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, v <span class="kw">in</span> groups.items():</span>
<span id="cb37-43"><a href="#cb37-43" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> node <span class="kw">in</span> v:</span>
<span id="cb37-44"><a href="#cb37-44" aria-hidden="true" tabindex="-1"></a>                        key <span class="op">=</span> k</span>
<span id="cb37-45"><a href="#cb37-45" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">break</span></span>
<span id="cb37-46"><a href="#cb37-46" aria-hidden="true" tabindex="-1"></a>                <span class="co"># set the &#39;group&#39; attribute for this node</span></span>
<span id="cb37-47"><a href="#cb37-47" aria-hidden="true" tabindex="-1"></a>                largest_cc.nodes[node][<span class="st">&#39;group&#39;</span>] <span class="op">=</span> key</span>
<span id="cb37-48"><a href="#cb37-48" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb37-49"><a href="#cb37-49" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb37-50"><a href="#cb37-50" aria-hidden="true" tabindex="-1"></a>        <span class="co"># lets extract the three largest subgraphs correspondong to the three largest communities</span></span>
<span id="cb37-51"><a href="#cb37-51" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;Building subgraphs of largest 3 communities...&quot;</span>)</span>
<span id="cb37-52"><a href="#cb37-52" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Create subgraphs dictionary</span></span>
<span id="cb37-53"><a href="#cb37-53" aria-hidden="true" tabindex="-1"></a>        subgraphs <span class="op">=</span> {i: [] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">max</span>(louvain_partition_og.values()) <span class="op">+</span> <span class="dv">1</span>)}</span>
<span id="cb37-54"><a href="#cb37-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-55"><a href="#cb37-55" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Add nodes to subgraphs</span></span>
<span id="cb37-56"><a href="#cb37-56" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> node, community_id <span class="kw">in</span> louvain_partition_og.items():</span>
<span id="cb37-57"><a href="#cb37-57" aria-hidden="true" tabindex="-1"></a>            subgraphs[community_id].append(node)</span>
<span id="cb37-58"><a href="#cb37-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-59"><a href="#cb37-59" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Sort subgraphs by size</span></span>
<span id="cb37-60"><a href="#cb37-60" aria-hidden="true" tabindex="-1"></a>        sorted_subgraphs <span class="op">=</span> <span class="bu">sorted</span>(subgraphs.values(), key<span class="op">=</span><span class="bu">len</span>, reverse<span class="op">=</span><span class="va">True</span>)[:<span class="dv">3</span>]</span>
<span id="cb37-61"><a href="#cb37-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-62"><a href="#cb37-62" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Create subgraphs from largest communities</span></span>
<span id="cb37-63"><a href="#cb37-63" aria-hidden="true" tabindex="-1"></a>        largest_subgraphs <span class="op">=</span> []</span>
<span id="cb37-64"><a href="#cb37-64" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> subgraph_nodes <span class="kw">in</span> sorted_subgraphs:</span>
<span id="cb37-65"><a href="#cb37-65" aria-hidden="true" tabindex="-1"></a>            subgraph <span class="op">=</span> G.subgraph(subgraph_nodes)</span>
<span id="cb37-66"><a href="#cb37-66" aria-hidden="true" tabindex="-1"></a>            largest_subgraphs.append(subgraph)</span>
<span id="cb37-67"><a href="#cb37-67" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb37-68"><a href="#cb37-68" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Set second group attribute based on subgraph membership only for 3 largest</span></span>
<span id="cb37-69"><a href="#cb37-69" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> only_paint_top_3:</span>
<span id="cb37-70"><a href="#cb37-70" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> node <span class="kw">in</span> largest_cc.nodes():</span>
<span id="cb37-71"><a href="#cb37-71" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> node <span class="kw">in</span> largest_subgraphs[<span class="dv">0</span>]:</span>
<span id="cb37-72"><a href="#cb37-72" aria-hidden="true" tabindex="-1"></a>                    largest_cc.nodes[node][<span class="st">&#39;group&#39;</span>] <span class="op">=</span> <span class="st">&#39;red&#39;</span></span>
<span id="cb37-73"><a href="#cb37-73" aria-hidden="true" tabindex="-1"></a>                <span class="cf">elif</span> node <span class="kw">in</span> largest_subgraphs[<span class="dv">1</span>]:</span>
<span id="cb37-74"><a href="#cb37-74" aria-hidden="true" tabindex="-1"></a>                    largest_cc.nodes[node][<span class="st">&#39;group&#39;</span>] <span class="op">=</span> <span class="st">&#39;blue&#39;</span></span>
<span id="cb37-75"><a href="#cb37-75" aria-hidden="true" tabindex="-1"></a>                <span class="cf">elif</span> node <span class="kw">in</span> largest_subgraphs[<span class="dv">2</span>]:</span>
<span id="cb37-76"><a href="#cb37-76" aria-hidden="true" tabindex="-1"></a>                    largest_cc.nodes[node][<span class="st">&#39;group&#39;</span>] <span class="op">=</span> <span class="st">&#39;green&#39;</span></span>
<span id="cb37-77"><a href="#cb37-77" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb37-78"><a href="#cb37-78" aria-hidden="true" tabindex="-1"></a>                    largest_cc.nodes[node][<span class="st">&#39;group&#39;</span>] <span class="op">=</span> <span class="st">&#39;grey&#39;</span></span>
<span id="cb37-79"><a href="#cb37-79" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb37-80"><a href="#cb37-80" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb37-81"><a href="#cb37-81" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Add to results</span></span>
<span id="cb37-82"><a href="#cb37-82" aria-hidden="true" tabindex="-1"></a>        results.append({})</span>
<span id="cb37-83"><a href="#cb37-83" aria-hidden="true" tabindex="-1"></a>        results[idx][<span class="st">&quot;largest_cc&quot;</span>] <span class="op">=</span> largest_cc</span>
<span id="cb37-84"><a href="#cb37-84" aria-hidden="true" tabindex="-1"></a>        results[idx][<span class="st">&quot;top_3_communities&quot;</span>] <span class="op">=</span> largest_subgraphs</span>
<span id="cb37-85"><a href="#cb37-85" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">&quot;&quot;</span>)</span>
<span id="cb37-86"><a href="#cb37-86" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb37-87"><a href="#cb37-87" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb37-88"><a href="#cb37-88" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> results</span></code></pre></div>
</div>
<div class="cell markdown"
data-cell_id="d8bce11a6c604970bc651a3e17c91e9a"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>Below we utilize our function and analyze our networks.</p>
</div>
<div class="cell code" data-cell_id="0370db39d8254f76bc064ffe72095209"
data-deepnote_cell_type="code" data-deepnote_to_be_reexecuted="false"
data-execution_millis="27723" data-execution_start="1683495071374"
data-source_hash="4b34a625">
<div class="sourceCode" id="cb38"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> mini_graphalyser(graphs)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Analysing 4 graphs
------------------------------
Analyzing Graph 0:
Extracting largest connected component...
Nodes in Largest Connected Component in Graph 1: 10450
Calculating louvain split...
Made partition
Modularity of Louvain Split: 0.88
Setting community attribute for all nodes in connected component...
Building subgraphs of largest 3 communities...

Analyzing Graph 1:
Extracting largest connected component...
Nodes in Largest Connected Component in Graph 2: 18000
Calculating louvain split...
Made partition
Modularity of Louvain Split: 0.90
Setting community attribute for all nodes in connected component...
Building subgraphs of largest 3 communities...

Analyzing Graph 2:
Extracting largest connected component...
Nodes in Largest Connected Component in Graph 3: 23813
Calculating louvain split...
Made partition
Modularity of Louvain Split: 0.89
Setting community attribute for all nodes in connected component...
Building subgraphs of largest 3 communities...

Analyzing Graph 3:
Extracting largest connected component...
Nodes in Largest Connected Component in Graph 4: 10947
Calculating louvain split...
Made partition
Modularity of Louvain Split: 0.78
Setting community attribute for all nodes in connected component...
Building subgraphs of largest 3 communities...

</code></pre>
</div>
</div>
<div class="cell markdown"
data-cell_id="2e660a80-fbda-42f5-a6b5-c21865ecfbef"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>We find that the louvain split results in a quite high and also very
similar modularity of 88% for the first decade, 90% and 89% for the next
two, and 79% for the last 4 years. This clearly indicates community
structures throughout the decades. Before we start analyzing the text
within these communities, lets just take a look at the size of the three
largest communities we have extracted and visualize some of the
graphs.</p>
</div>
<div class="cell code" data-cell_id="60e36167b819407e805f02b3f18f6cc5"
data-deepnote_cell_type="code" data-deepnote_to_be_reexecuted="false"
data-execution_millis="5" data-execution_start="1683494524585"
data-source_hash="&quot;75492979&quot;">
<div class="sourceCode" id="cb40"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx, graph_analysis <span class="kw">in</span> <span class="bu">enumerate</span>(results):</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">&quot;Graph of largest connected component for years:</span><span class="ch">\n</span><span class="st">&quot;</span>,years_list[idx])</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="dv">30</span><span class="op">*</span><span class="st">&quot;-&quot;</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  largest_cc <span class="op">=</span> graph_analysis[<span class="st">&#39;largest_cc&#39;</span>]</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  three_largest <span class="op">=</span> graph_analysis[<span class="st">&#39;top_3_communities&#39;</span>]</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> community <span class="kw">in</span> three_largest:</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&#39;Number of nodes in community: </span><span class="sc">{</span>community<span class="sc">.</span>number_of_nodes()<span class="sc">}</span><span class="ss"> or </span><span class="sc">{</span>community<span class="sc">.</span>number_of_nodes()<span class="op">/</span>largest_cc<span class="sc">.</span>number_of_nodes()<span class="sc">:.2f}</span><span class="ss">%&#39;</span>)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">&quot;&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Graph of largest connected component for years:
 [1990, 1991, 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999]
------------------------------
Number of nodes in community: 949 or 0.09%
Number of nodes in community: 751 or 0.07%
Number of nodes in community: 521 or 0.05%

Graph of largest connected component for years:
 [2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009]
------------------------------
Number of nodes in community: 1372 or 0.08%
Number of nodes in community: 1034 or 0.06%
Number of nodes in community: 1018 or 0.06%

Graph of largest connected component for years:
 [2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019]
------------------------------
Number of nodes in community: 2170 or 0.09%
Number of nodes in community: 1563 or 0.07%
Number of nodes in community: 1500 or 0.06%

Graph of largest connected component for years:
 [2020, 2021, 2022, 2023, 2024, 2025, 2026, 2027, 2028, 2029]
------------------------------
Number of nodes in community: 934 or 0.09%
Number of nodes in community: 885 or 0.08%
Number of nodes in community: 826 or 0.08%

</code></pre>
</div>
</div>
<div class="cell markdown"
data-cell_id="59b07554-c70d-4270-916d-a63bd98ac780"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>To better compare the above results we also visualize the relative
size.</p>
</div>
<div class="cell code" data-cell_id="9088358ad60c4203a58509ccad4e2d4e"
data-deepnote_cell_type="code" data-deepnote_to_be_reexecuted="false"
data-execution_millis="502" data-execution_start="1683494527591"
data-source_hash="58ca2ea7">
<div class="sourceCode" id="cb42"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the data</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="dv">3</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>y1 <span class="op">=</span> np.array([graph.number_of_nodes() <span class="cf">for</span> graph <span class="kw">in</span> results[<span class="dv">0</span>][<span class="st">&#39;top_3_communities&#39;</span>]])<span class="op">/</span>results[<span class="dv">0</span>][<span class="st">&#39;largest_cc&#39;</span>].number_of_nodes()</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>y2 <span class="op">=</span> np.array([graph.number_of_nodes() <span class="cf">for</span> graph <span class="kw">in</span> results[<span class="dv">1</span>][<span class="st">&#39;top_3_communities&#39;</span>]])<span class="op">/</span>results[<span class="dv">1</span>][<span class="st">&#39;largest_cc&#39;</span>].number_of_nodes()</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>y3 <span class="op">=</span> np.array([graph.number_of_nodes() <span class="cf">for</span> graph <span class="kw">in</span> results[<span class="dv">2</span>][<span class="st">&#39;top_3_communities&#39;</span>]])<span class="op">/</span>results[<span class="dv">2</span>][<span class="st">&#39;largest_cc&#39;</span>].number_of_nodes()</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>y4 <span class="op">=</span> np.array([graph.number_of_nodes() <span class="cf">for</span> graph <span class="kw">in</span> results[<span class="dv">3</span>][<span class="st">&#39;top_3_communities&#39;</span>]])<span class="op">/</span>results[<span class="dv">3</span>][<span class="st">&#39;largest_cc&#39;</span>].number_of_nodes()</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the width of the bars</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>bar_width <span class="op">=</span> <span class="fl">0.2</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a figure and axis object</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">6</span>))</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the bars</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>ax.bar(x <span class="op">-</span> bar_width, y1, width<span class="op">=</span>bar_width, label<span class="op">=</span><span class="st">&#39;1990-1999&#39;</span>)</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>ax.bar(x, y2, width<span class="op">=</span>bar_width, label<span class="op">=</span><span class="st">&#39;2000-2009&#39;</span>)</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>ax.bar(x <span class="op">+</span> bar_width, y3, width<span class="op">=</span>bar_width, label<span class="op">=</span><span class="st">&#39;2010-2019&#39;</span>)</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>ax.bar(x <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>bar_width, y4, width<span class="op">=</span>bar_width, label<span class="op">=</span><span class="st">&#39;2020-present&#39;</span>)</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Add labels and title</span></span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">&#39;Community sizes&#39;</span>)</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">&#39;Percentage of Graph Nodes in community&#39;</span>)</span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">&#39;Relative Size of the largest three communities in each of the four giant connected components&#39;</span>)</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Add x-tick labels</span></span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>ax.set_xticks(x <span class="op">+</span> bar_width <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>ax.set_xticklabels([<span class="st">&#39;Largest&#39;</span>, <span class="st">&#39;Second Largest&#39;</span>, <span class="st">&#39;Third Largest&#39;</span>])</span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a legend</span></span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot</span></span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_9447875aee7648dcaa153aef3c707f9d/2b2267857a9f8865d11f5563980b00f008c06848.png"
width="862" height="547" /></p>
</div>
</div>
<div class="cell markdown"
data-cell_id="310d3c56-9726-4382-8190-a97b945460d5"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>We see not surprisingly that the community with the least amount of
nodes, for the timeframe 2020-2023 has the highest relative size. This
is due to the fact that the timeframe only spans 3 years, and the
community sizes are computed as the amount of nodes in the community
divided by the total amount of nodes in the graph. Although, this could
indicate that the papers writting in the period of 2020-2023 are more
community based than the papers written in the other decades.</p>
</div>
<div class="cell markdown"
data-cell_id="cda18bcb-0cd1-402b-a06d-49e857c182df"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>Let's visualize the giant components for each of the four 'decades'
to better see whats going on. For each century we provide two plots; one
where all communities found by the louvain split have been colored, and
tone where only the three largest communities found by the louvain split
are marked by color. In the code we have only run the analysis for the
case where we set the color/group attribute of the nodes for all
communities, but to change this one should simply change the argument
"only_paint_top_3 "in "mini_graphalyzer" to be true.</p>
</div>
<div class="cell markdown"
data-cell_id="97cce525-7db2-4ba2-85c9-e9af04692a13"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>The plots are made with the interactive graph visualizer from netwulf
by running the code beneath:</p>
</div>
<div class="cell code" data-cell_id="3e3a52720ea34e8eb1070c4e6dcc7f54"
data-deepnote_cell_type="code" data-deepnote_to_be_reexecuted="false"
data-execution_millis="0" data-execution_start="1683494531799"
data-source_hash="e60cfcc0">
<div class="sourceCode" id="cb43"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lets plot the components, with the three largest </span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="co">#exit()</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="co">#nw.visualize(results[0][&#39;largest_cc&#39;])</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co">#nw.visualize(results[1][&#39;largest_cc&#39;])</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="co">#nw.visualize(results[2][&#39;largest_cc&#39;])</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="co">#nw.visualize(results[3][&#39;largest_cc&#39;])</span></span></code></pre></div>
</div>
<div class="cell markdown"
data-cell_id="4316bc21d3ce47a2a4e2d49548f4fbbb"
data-deepnote_cell_type="markdown">
<div style="display:flex">
  <figure style="margin:0">
    <img src="/work/1990_1999.png" style="width:85%">
    <figcaption style="text-align:center">1990-1999</figcaption>
  </figure>
  <figure style="margin:0">
    <img src="/work/1990_1999_top3.png" style="width:250%">
    <figcaption style="text-align:center">1990-1999 Largest 3 Communities</figcaption>
  </figure>
</div>
</div>
<div class="cell markdown"
data-cell_id="f7d09ad2c19c4e7f9ad0990c39caa330"
data-deepnote_cell_type="markdown">
<div style="display:flex">
  <figure style="margin:0">
    <img src="/work/2000_2009.png" style="width:90%">
    <figcaption style="text-align:center">2000-2009</figcaption>
  </figure>
  <figure style="margin:0">
    <img src="/work/2000_2009_top3.png" style="width:180%">
    <figcaption style="text-align:center">2000-2009 Largest 3 Communities</figcaption>
  </figure>
</div>
</div>
<div class="cell markdown"
data-cell_id="dbcf51eac1c745aaa1ea3ae545dd22d9"
data-deepnote_cell_type="markdown">
<div style="display:flex">
  <figure style="margin:0">
    <img src="/work/2010_2019.png" style="width:100%">
    <figcaption style="text-align:center">2010-2019</figcaption>
  </figure>
  <figure style="margin:0">
    <img src="/work/2010_2019_top3.png" style="width:100%">
    <figcaption style="text-align:center">2010-2019 Largest 3 Communities</figcaption>
  </figure>
</div>
</div>
<div class="cell markdown"
data-cell_id="50328250b8174313a131cd8d24004b36"
data-deepnote_cell_type="markdown">
<div style="display:flex">
  <figure style="margin:0">
    <img src="/work/2020_present.png" style="width:100%">
    <figcaption style="text-align:center">2020-present</figcaption>
  </figure>
  <figure style="margin:0">
    <img src="/work/2020_present_top3.png" style="width:95%">
    <figcaption style="text-align:center">2020-present Largest 3 Communities</figcaption>
  </figure>
</div>
</div>
<div class="cell markdown"
data-cell_id="5ff2aede33d44af4abbc847a20c85d0a"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>From the plots above, we clearly see the community structure as found
by the louvain algorithm fitting well together with the high modularity
we found.</p>
</div>
<div class="cell markdown"
data-cell_id="2316dd422d42449c973d27e7c3c6e395"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>As a last thing before we move on to the text analysis, we
investigate how the average citation count within the largest 3
communities compares to the average citation count of the entire giant
component of their corresponding decade. With this we hope to verify
that using the size of the community for choosing relevant communities
makes sense.</p>
</div>
<div class="cell code" data-cell_id="0130698d77604328b7bf4e506cee33c7"
data-deepnote_cell_type="code" data-deepnote_to_be_reexecuted="false"
data-execution_millis="66" data-execution_start="1683494543196"
data-source_hash="8d441b01">
<div class="sourceCode" id="cb44"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx, graph_analysis <span class="kw">in</span> <span class="bu">enumerate</span>(results):</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>    component_average_citation_count <span class="op">=</span> np.mean(<span class="bu">list</span>(nx.get_node_attributes(graph_analysis[<span class="st">&#39;largest_cc&#39;</span>], <span class="st">&quot;citationCount&quot;</span>).values()))</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    largest_community_average_citation_count <span class="op">=</span> np.mean(<span class="bu">list</span>(nx.get_node_attributes(graph_analysis[<span class="st">&#39;top_3_communities&#39;</span>][<span class="dv">0</span>], <span class="st">&quot;citationCount&quot;</span>).values()))</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    second_largest_community_average_citation_count <span class="op">=</span> np.mean(<span class="bu">list</span>(nx.get_node_attributes(graph_analysis[<span class="st">&#39;top_3_communities&#39;</span>][<span class="dv">1</span>], <span class="st">&quot;citationCount&quot;</span>).values()))</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    third_largest_community_average_citation_count <span class="op">=</span> np.mean(<span class="bu">list</span>(nx.get_node_attributes(graph_analysis[<span class="st">&#39;top_3_communities&#39;</span>][<span class="dv">2</span>], <span class="st">&quot;citationCount&quot;</span>).values()))</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;-------Decade &quot;</span>, idx, <span class="st">&quot;--------&quot;</span>)</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Average citation count in largest connected component: </span><span class="sc">{</span>component_average_citation_count<span class="sc">:.2f}</span><span class="ss">&quot;</span>)</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Average citation count in largest community: </span><span class="sc">{</span>largest_community_average_citation_count<span class="sc">:.2f}</span><span class="ss">&quot;</span>)</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Average citation count in second largest connected component: </span><span class="sc">{</span>second_largest_community_average_citation_count<span class="sc">:.2f}</span><span class="ss">&quot;</span>)</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Average citation count in third largest connected component: </span><span class="sc">{</span>third_largest_community_average_citation_count<span class="sc">:.2f}</span><span class="ch">\n</span><span class="ss">&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>-------Decade  0 --------
Average citation count in largest connected component: 107.31
Average citation count in largest community: 201.79
Average citation count in second largest connected component: 74.38
Average citation count in third largest connected component: 140.66

-------Decade  1 --------
Average citation count in largest connected component: 88.66
Average citation count in largest community: 118.83
Average citation count in second largest connected component: 140.37
Average citation count in third largest connected component: 57.21

-------Decade  2 --------
Average citation count in largest connected component: 53.33
Average citation count in largest community: 47.00
Average citation count in second largest connected component: 43.28
Average citation count in third largest connected component: 30.92

-------Decade  3 --------
Average citation count in largest connected component: 16.71
Average citation count in largest community: 15.93
Average citation count in second largest connected component: 21.95
Average citation count in third largest connected component: 13.79

</code></pre>
</div>
</div>
<div class="cell markdown"
data-cell_id="4060f8bf74964550bfb61efb29f3fd1c"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>We find that the average citation count within the communities
match</p>
</div>
<section
id="text-analysis-tying-network-theory-and-text-analysis-together"
class="cell markdown" data-cell_id="f17b9dce48144bea86ebff2d6d19d77e"
data-deepnote_cell_type="text-cell-h2"
data-formattedRanges="[{&quot;fromCodePoint&quot;:0,&quot;marks&quot;:{&quot;bold&quot;:true},&quot;toCodePoint&quot;:62,&quot;type&quot;:&quot;marks&quot;}]">
<h2>Text-Analysis: Tying network theory and text analysis together</h2>
</section>
<div class="cell markdown"
data-cell_id="aac8bc68-1b11-4908-a6a0-09292843e51e"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>Now that we have examined our graphs lets move on and investigate the
text within these communities.</p>
</div>
<div class="cell markdown"
data-cell_id="ac34da32-92dc-4dd3-9de4-ba88ed87e3db"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>To analyse the abstracts within communities, the TF-IDF methods is
applied. Firstly, all abstracts needs to be tokenised. The tokenised is
based on the NLTK word_tokenizer, which essentially just splits the
document based on white space. We can then import a dicitionary of stop
words, and define our own filter on characters to further filter the
tokens. This way we will get a more indicative list of words used in
each abstract.</p>
</div>
<div class="cell markdown"
data-cell_id="b5bf98ca6ab8485aaf7b740b134e408a"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>Now we can proceed to define a function to analyse a community. As
mentioned, the analysis is based on the Term Frequency - Inverse
Document Frequency approach. Let's recall what the TF-IDF means.</p>
</div>
<div class="cell markdown"
data-cell_id="b9c749aa-965b-4eb6-8d02-84c4abdbad8f"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>Term Frequence Inverse Document Frequency, is a way to quantify
words' explained variance across documents. Term Frequency is simply how
often a term occurs in a document. It 'explains' the weight of the word
in term of a document. Inverse Document Frequency is the logarithm to
the number of documents the term occurs in, out of all documents. The
TF-IDF is the product of the TF and IDF, and has the following form:</p>
</div>
<div class="cell markdown"
data-cell_id="e4881659d9474e308a716c73d8c7acdd"
data-deepnote_cell_type="markdown">
<p><span class="math inline">$w_{i,j} = tf_{i,j} \times
\operatorname{log}\left(\frac{N}{df_i}\right )$</span></p>
</div>
<div class="cell markdown"
data-cell_id="848fe52f-574c-4ba1-8866-daa075c99323"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>The higher the TF the more weight the word has, but if it occurs in
all other documents as well, the logarithm will be 0 and the product 0,
and the importance of the word for the document is therefore none.
Likewise, if the IDF is high and the TF is high, the word explains much
of the variance.</p>
</div>
<div class="cell markdown"
data-cell_id="a335b16f-06e4-4768-a2e3-ea1a37804437"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>With the</p>
</div>
<div class="cell code" data-cell_id="d5e667d43a6b4e5d8caf9ae2b37816db"
data-deepnote_cell_type="code" data-deepnote_to_be_reexecuted="false"
data-execution_millis="0" data-execution_start="1683494971222"
data-source_hash="b7999117">
<div class="sourceCode" id="cb46"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_extraction.text <span class="im">import</span> TfidfVectorizer</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>stopwords_english <span class="op">=</span> <span class="bu">list</span>(stopwords.words(<span class="st">&quot;english&quot;</span>))</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>tfidf <span class="op">=</span> TfidfVectorizer(stop_words<span class="op">=</span>stopwords_english)</span></code></pre></div>
</div>
<div class="cell code" data-cell_id="ff7807f0ea8d4de78ac43e1476568109"
data-deepnote_cell_type="code" data-deepnote_to_be_reexecuted="false"
data-execution_millis="6" data-execution_start="1683494602182"
data-source_hash="2f51a974">
<div class="sourceCode" id="cb47"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>top_term_df <span class="op">=</span> pd.DataFrame(columns<span class="op">=</span>[<span class="st">&quot;decade&quot;</span>, <span class="st">&quot;community&quot;</span>, <span class="st">&quot;top_terms&quot;</span>])</span></code></pre></div>
</div>
<div class="cell code" data-cell_id="353ff2e6b10a43aa8310675e98f66efd"
data-deepnote_cell_type="code" data-deepnote_to_be_reexecuted="false"
data-execution_millis="4" data-execution_start="1683494988799"
data-source_hash="caa322d9">
<div class="sourceCode" id="cb48"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> TextAnal(graph, decade, community):</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Function to perform TF-IDF analysis of a community and return a wordcloud</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="co">        graph (graph): graph of interest</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>    community_ids <span class="op">=</span> <span class="bu">list</span>(graph.nodes)</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;Number of nodes in community: </span><span class="sc">{</span><span class="bu">len</span>(community_ids)<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get all tokens for community</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>    query <span class="op">=</span> {<span class="st">&quot;_id&quot;</span>: {<span class="st">&quot;$in&quot;</span>: community_ids}}</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get only tokens</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">filter</span> <span class="op">=</span> {<span class="st">&quot;_id&quot;</span>:<span class="dv">0</span>, <span class="st">&quot;title&quot;</span>:<span class="dv">0</span>, <span class="st">&quot;abstract&quot;</span>:<span class="dv">0</span>, <span class="st">&quot;year&quot;</span>:<span class="dv">0</span>,<span class="st">&quot;citationCount&quot;</span>: <span class="dv">0</span>,<span class="st">&quot;references&quot;</span>:<span class="dv">0</span>}</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Getting tokens for community&quot;</span>)</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>    tokens_community <span class="op">=</span> mongoDB(query, <span class="bu">filter</span>)</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># tokens_community = paper_df[paper_df[&quot;_id&quot;].isin(community_ids)]</span></span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># tokens_community is a dataframe with a single column, &quot;tokens&quot;, we can explode this to get a list of all tokens</span></span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>    all_tokens_exploded <span class="op">=</span> <span class="st">&quot; &quot;</span>.join(tokens_community.explode(<span class="st">&quot;tokens&quot;</span>)[<span class="st">&quot;tokens&quot;</span>].values.tolist())</span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fit tfidf model</span></span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Fitting TF-IDF model&quot;</span>)</span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>    tfidf_scores <span class="op">=</span> tfidf.fit_transform([all_tokens_exploded])</span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get top 100 terms</span></span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>    n_terms <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a>    feature_array <span class="op">=</span> np.array(tfidf.get_feature_names_out())</span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a>    tfidf_sorting <span class="op">=</span> np.argsort(tfidf_scores.toarray()).flatten()[::<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a>    top_terms <span class="op">=</span> feature_array[tfidf_sorting][:n_terms]</span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add to dataframe</span></span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a>    top_term_df.loc[<span class="bu">len</span>(top_term_df)] <span class="op">=</span> [decade, community, top_terms[:<span class="dv">3</span>]]</span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-38"><a href="#cb48-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create word cloud</span></span>
<span id="cb48-39"><a href="#cb48-39" aria-hidden="true" tabindex="-1"></a>    Cloud <span class="op">=</span> WordCloud(background_color<span class="op">=</span><span class="st">&quot;white&quot;</span>, max_words<span class="op">=</span>n_terms,</span>
<span id="cb48-40"><a href="#cb48-40" aria-hidden="true" tabindex="-1"></a>                      contour_width<span class="op">=</span><span class="dv">3</span>, contour_color<span class="op">=</span><span class="st">&#39;steelblue&#39;</span>,</span>
<span id="cb48-41"><a href="#cb48-41" aria-hidden="true" tabindex="-1"></a>                      height<span class="op">=</span><span class="dv">400</span>).generate(<span class="st">&#39; &#39;</span>.join(top_terms))</span>
<span id="cb48-42"><a href="#cb48-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-43"><a href="#cb48-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Cloud</span></code></pre></div>
</div>
<div class="cell markdown"
data-cell_id="c061a9a6-6701-412a-bed7-e5087c080917"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>From these wordclouds we see that in the earliest decades there
seemed to be a focus on the humane side of AI, mainly seen in the second
and third largest communities. Here we see that the second community
seems to revolve largely around the biological usage of AI, where the
third community focuses on children and students and education. The
largest community focuses on the more technical side of AI, with a focus
on the mode, agent and system. This community is of interest, as in the
next decade we see a new community that seems to focus on the same
topics. Community 2 of 2000 focuses on many of the same topics as
community 1 of 1990, which could indicate that in 2000 the focus of AI
was shifted more towards the social and humanistic side. This is seen in
the largest community in 2000 revolving around 'individual',
'relationship', 'emotion' and 'social'. In the third community of 2000
they seem solely focused on the model and testing part of AI.In 2010 we
see a shift towards the communities being more focused on applied AI,
and problem solving with words such as 'problem', 'method', 'solution',
'results'. In this decade there does not seem to be a distringuisable
community from the previous decades, but rather a mix of some of them.
This shows that the field of AI, atleast in terms of the Artifical
Intelligence keyword, is always evolving and the perception and focus is
changing.In the last decade of 2020 there seem to be a general focus on
the model and system part, like the other decades. For the largest and
second largest community, they seem to have honed in on the application
and usefulness part of AI where the third largest community is more
focused on Healthcare and especially covid-19. This is not surprising,
as the covid-19 pandemic has been a large part of the last year, and
therefore it is natural that it is a large part of the research as
well.</p>
</div>
<div class="cell code" data-cell_id="95673455d1294dc5876a3ae83296def0"
data-deepnote_cell_type="code" data-deepnote_to_be_reexecuted="false"
data-execution_millis="7" data-execution_start="1683494608936"
data-source_hash="27e710b5">
<div class="sourceCode" id="cb49"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(top_term_df)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Empty DataFrame
Columns: [decade, community, top_terms]
Index: []
</code></pre>
</div>
</div>
<div class="cell code" data-cell_id="eb32705448c847ccbcd9778ba602bb34"
data-deepnote_cell_type="code" data-deepnote_to_be_reexecuted="false"
data-execution_millis="37572" data-execution_start="1683495033873"
data-source_hash="41e1ab7e">
<div class="sourceCode" id="cb51"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">4</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">12</span>))</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>fig.set_dpi(<span class="dv">150</span>)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">&#39;Top 100 terms for each decades top 3 communities&#39;</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>decade_list <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">1990</span>, <span class="dv">2000</span>, <span class="dv">2010</span>, <span class="dv">2020</span>]</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, decade <span class="kw">in</span> <span class="bu">enumerate</span>(results):</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j, community <span class="kw">in</span> <span class="bu">enumerate</span>(decade[<span class="st">&#39;top_3_communities&#39;</span>]):</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>        axes[i, j].imshow(TextAnal(community, i, j), interpolation<span class="op">=</span><span class="st">&#39;bilinear&#39;</span>)</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>        axes[i, j].set_title(<span class="ss">f&quot;Community </span><span class="sc">{</span>j<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss"> in decade </span><span class="sc">{</span>decade_list[i<span class="op">+</span><span class="dv">1</span>]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>        axes[i, j].axis(<span class="st">&quot;off&quot;</span>)</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>fig.tight_layout(pad<span class="op">=</span><span class="fl">2.0</span>) </span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Number of nodes in community: 898
Getting tokens for community
Fitting TF-IDF model
Number of nodes in community: 753
Getting tokens for community
Fitting TF-IDF model
Number of nodes in community: 609
Getting tokens for community
Fitting TF-IDF model
Number of nodes in community: 1075
Getting tokens for community
Fitting TF-IDF model
Number of nodes in community: 1037
Getting tokens for community
Fitting TF-IDF model
Number of nodes in community: 1022
Getting tokens for community
Fitting TF-IDF model
Number of nodes in community: 2107
Getting tokens for community
Fitting TF-IDF model
Number of nodes in community: 1567
Getting tokens for community
Fitting TF-IDF model
Number of nodes in community: 1492
Getting tokens for community
Fitting TF-IDF model
Number of nodes in community: 887
Getting tokens for community
Fitting TF-IDF model
Number of nodes in community: 847
Getting tokens for community
Fitting TF-IDF model
Number of nodes in community: 787
Getting tokens for community
Fitting TF-IDF model
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_9447875aee7648dcaa153aef3c707f9d/57afb510377cb3de57baf9375d5386196770c5ad.png"
width="1500" height="1752" /></p>
</div>
</div>
<section id="part-4---discussion-think-critically-about-your-creation"
class="cell markdown" data-cell_id="adb5ebdcd0de4ae3aa1633c053eb5d9f"
data-deepnote_cell_type="text-cell-h2" data-formattedRanges="[]">
<h2>Part 4 - Discussion. Think critically about your creation</h2>
</section>
<div class="cell markdown"
data-cell_id="9c93b8fdb12a4107bb2b0217445cb07c"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>In this section, we reflect on the different elements of the project
and how they were carried out. Like all other projects, this one is far
from perfect and we have used methods that make aspects such as bias,
representativeness and validity debatable. Additionally, there is a
number of things that we would have liked to improve on, but for which
we either did not have enough time or were blocked by a problem that we
did not manage to solve.</p>
</div>
<section id="data-collection" class="cell markdown"
data-cell_id="6203501aac0e4a988eb68e8230cb9bbb"
data-deepnote_cell_type="text-cell-h3" data-formattedRanges="[]">
<h3>Data collection</h3>
</section>
<div class="cell markdown"
data-cell_id="ec0a100d-c714-4d06-a5f2-756d679a2c7f"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>As our data collection process involved searching a large database by
relevance, which ever heuristic was used to score relevance became a
bias in our dataset. Certain topics that are talked a lot about today
may somehow be able to influence the relevance scores of different
papers. Thus papers that were not very relevant at the time of
publishing may be very relevant today and is therefore more likely to
make its way into our analysis. This is a clear potential bias resulting
from the black box algorithm used to score relevance by semantic
scholar.</p>
</div>
<section id="graph-analysis" class="cell markdown"
data-cell_id="1f9941fd5e6e4d69928cf0db1318fe7e"
data-deepnote_cell_type="text-cell-h3" data-formattedRanges="[]">
<h3>Graph analysis</h3>
</section>
<div class="cell markdown"
data-cell_id="503756ea-b799-47b2-88c7-569f61a21839"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>We might have been able to find more representative communities by
somehow weighting the communities according to citation counts. However,
there is now information as to when the citations were from or what
citation count a paper had at the end of a given decade. This could thus
introduce some after-the-fact bias for research arease that have
suddenly been revived after lying dormant for a number of years</p>
</div>
<div class="cell markdown"
data-cell_id="5ea93b91-3284-4cec-8035-8d2853aeefb1"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>Given more time, we would have liked to make a higher resolution
analysis where we would track the evolution of the communities with a
sliding window fashion such that we could use window overlaps to map
discovered communities to each other between time periods.</p>
</div>
<section id="text-analysis" class="cell markdown"
data-cell_id="90589257536c40149d6ef1288f978e82"
data-deepnote_cell_type="text-cell-h3" data-formattedRanges="[]">
<h3>Text analysis</h3>
</section>
<div class="cell markdown"
data-cell_id="7c5554fe43df4ae28592df12c2cb26fd"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>For a TF-IDF analysis it is imperative that the tokenisation is done
correctly. For this project we only regarded english texts, therefore we
might have missed some valuable tokens that were not in english. On the
other hand, one could argue that they were of little value given they
are in another language. However, this is a bias that we have introduced
to our analysis. Additionally, we did not have time to do a more
thorough analysis of the tokens, such as stemming and lemmatization.
This could have given us a more accurate representation of the tokens
used in the abstracts. In addition to this, we could have looked at
using n-grams instead of single tokens. This could have given us a
better understanding of the context of the tokens, and how they are used
in the abstracts. Furthermore, the use of n-grams could help us catch
phrases such as artifical intelligence and emotional intelligence. We
see a large quantity of 'intelligence' in the wordclouds, which could be
avoided this way.</p>
</div>
<div class="cell markdown" data-created_in_deepnote_cell="true"
data-deepnote_cell_type="markdown">
<p><a style='text-decoration:none;line-height:16px;display:flex;color:#5B5B62;padding:10px;justify-content:end;' href='https://deepnote.com?utm_source=created-in-deepnote-cell&projectId=f067ccc6-b90d-4165-a98d-51b5a97e3c36' target="_blank">
<img alt='Created in deepnote.com' style='display:inline;max-height:16px;margin:0px;margin-right:7.5px;' src='data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iODBweCIgaGVpZ2h0PSI4MHB4IiB2aWV3Qm94PSIwIDAgODAgODAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU0LjEgKDc2NDkwKSAtIGh0dHBzOi8vc2tldGNoYXBwLmNvbSAtLT4KICAgIDx0aXRsZT5Hcm91cCAzPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9IkxhbmRpbmciIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSJBcnRib2FyZCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTEyMzUuMDAwMDAwLCAtNzkuMDAwMDAwKSI+CiAgICAgICAgICAgIDxnIGlkPSJHcm91cC0zIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMjM1LjAwMDAwMCwgNzkuMDAwMDAwKSI+CiAgICAgICAgICAgICAgICA8cG9seWdvbiBpZD0iUGF0aC0yMCIgZmlsbD0iIzAyNjVCNCIgcG9pbnRzPSIyLjM3NjIzNzYyIDgwIDM4LjA0NzY2NjcgODAgNTcuODIxNzgyMiA3My44MDU3NTkyIDU3LjgyMTc4MjIgMzIuNzU5MjczOSAzOS4xNDAyMjc4IDMxLjY4MzE2ODMiPjwvcG9seWdvbj4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0zNS4wMDc3MTgsODAgQzQyLjkwNjIwMDcsNzYuNDU0OTM1OCA0Ny41NjQ5MTY3LDcxLjU0MjI2NzEgNDguOTgzODY2LDY1LjI2MTk5MzkgQzUxLjExMjI4OTksNTUuODQxNTg0MiA0MS42NzcxNzk1LDQ5LjIxMjIyODQgMjUuNjIzOTg0Niw0OS4yMTIyMjg0IEMyNS40ODQ5Mjg5LDQ5LjEyNjg0NDggMjkuODI2MTI5Niw0My4yODM4MjQ4IDM4LjY0NzU4NjksMzEuNjgzMTY4MyBMNzIuODcxMjg3MSwzMi41NTQ0MjUgTDY1LjI4MDk3Myw2Ny42NzYzNDIxIEw1MS4xMTIyODk5LDc3LjM3NjE0NCBMMzUuMDA3NzE4LDgwIFoiIGlkPSJQYXRoLTIyIiBmaWxsPSIjMDAyODY4Ij48L3BhdGg+CiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMCwzNy43MzA0NDA1IEwyNy4xMTQ1MzcsMC4yNTcxMTE0MzYgQzYyLjM3MTUxMjMsLTEuOTkwNzE3MDEgODAsMTAuNTAwMzkyNyA4MCwzNy43MzA0NDA1IEM4MCw2NC45NjA0ODgyIDY0Ljc3NjUwMzgsNzkuMDUwMzQxNCAzNC4zMjk1MTEzLDgwIEM0Ny4wNTUzNDg5LDc3LjU2NzA4MDggNTMuNDE4MjY3Nyw3MC4zMTM2MTAzIDUzLjQxODI2NzcsNTguMjM5NTg4NSBDNTMuNDE4MjY3Nyw0MC4xMjg1NTU3IDM2LjMwMzk1NDQsMzcuNzMwNDQwNSAyNS4yMjc0MTcsMzcuNzMwNDQwNSBDMTcuODQzMDU4NiwzNy43MzA0NDA1IDkuNDMzOTE5NjYsMzcuNzMwNDQwNSAwLDM3LjczMDQ0MDUgWiIgaWQ9IlBhdGgtMTkiIGZpbGw9IiMzNzkzRUYiPjwvcGF0aD4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+' >
</img> Created in
<span style='font-weight:600;margin-left:4px;'>Deepnote</span></a></p>
</div>
</body>
</html>
